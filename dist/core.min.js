class StringLoader{constructor(){this._strings=new Map,this._cache=new Map,this._extensionStrings=new Map,this._langList=window.GRAPHTOOL_CONFIG?.LANGUAGE?.LANGUAGE_LIST||["en","English"],this._currentLang="en",this._observers=new Set,this._fallbackChain=["en"],this._boundObservers=new WeakMap,this._activeExtensionList=[],window.GRAPHTOOL_CONFIG?.LANGUAGE?.ENABLE_I18N&&window.GRAPHTOOL_CONFIG?.LANGUAGE?.ENABLE_SYSTEM_LANG_DETECTION&&(this._currentLang=this._detectLanguage()),this.loadLanguage(this._currentLang)}_detectLanguage(){const e=navigator.language.split("-")[0];return this._langList.map((([e,t])=>e)).includes(e)?e:"en"}static getInstance(){return StringLoader._instance||(StringLoader._instance=new StringLoader),StringLoader._instance}async loadLanguage(e,t=!1){try{if(document.documentElement.setAttribute("data-loading",""),!t&&this._cache.has(e))return this._strings=new Map(this._cache.get(e)),this._currentLang=e,await this.loadExtensionStrings(),this._notifyObservers(),!0;const n=await fetch(import.meta.resolve(`./assets/strings/${e}.json`));if(!n.ok)throw new Error(`Language ${e} not found`);const r=await n.json();return this._strings.clear(),this._processStrings("",r),this._cache.set(e,new Map(this._strings)),this._currentLang=e,await this.loadExtensionStrings(),this._notifyObservers(),!0}catch(e){return console.error("Failed to load language:",e),!1}finally{document.documentElement.removeAttribute("data-loading")}}_processStrings(e,t){for(const[n,r]of Object.entries(t)){const t=e?`${e}.${n}`:n;"object"==typeof r&&null!==r?this._processStrings(t,r):this._strings.set(t,r)}}getString(e,t=e){let n=this._strings.get(e);if(n)return n;for(const t of this._fallbackChain)if(t!==this._currentLang&&(n=this._cache.get(t)?.get(e),n))return n;return t}getCurrentLanguage(){return this._currentLang}addObserver(e){const t=e.bind(this);this._boundObservers.set(e,t),this._observers.add(t)}removeObserver(e){const t=this._boundObservers.get(e);t&&(this._observers.delete(t),this._boundObservers.delete(e))}_notifyObservers(){for(const e of this._observers)e(this._currentLang)}async loadExtensionStrings(){this._activeExtensionList=await this.updateActiveExtensionList(),await Promise.all(this._activeExtensionList.map((async e=>{try{const t=await fetch(`./extensions/${e.NAME}/strings/${this._currentLang}.json`);if(!t.ok)throw new Error;const n=await t.json();this._extensionStrings.set(e.NAME,n),this._processStrings(`extension.${e.NAME}`,n)}catch(t){console.warn(`No strings found for extension: ${e.NAME}`)}})))}async updateActiveExtensionList(){try{const{EXTENSION_CONFIG:e}=await import(import.meta.resolve("./extensions/extensions.config.js"));return e.filter((e=>e.I18N_ENABLED))}catch(e){return console.error("modernGraphTool: Failed to load extension configuration -",e),[]}}}var e=StringLoader.getInstance();class ConfigGetter{constructor(){this._config=window.GRAPHTOOL_CONFIG,this._cache=new Map,e.addObserver((()=>{this._cache.clear()}))}static getInstance(){return ConfigGetter._instance||(ConfigGetter._instance=new ConfigGetter),ConfigGetter._instance}get(t){const n=`${e.getCurrentLanguage()}:${t}`;if(this._cache.has(n))return this._cache.get(n);const r=this._getValueByPath(t);if(!r)return null;const i=this._processValue(r);return this._cache.set(n,i),i}_processValue(t){if(t&&"object"==typeof t&&t.i18n){const n=e.getCurrentLanguage(),r=t.i18n.en||t.default,i=t.i18n[n];if(!i)return r;if(Array.isArray(r))return r.map(((e,t)=>{const n=i[t];return n?this._mergeWithSharedValues(e,n):e}));if("object"==typeof r)return{...r,...i};if("string"==typeof r){if("true"===r.toLowerCase())return!0;if("false"===r.toLowerCase())return!1}return i}return t}getDefault(e){const t=this._getValueByPath(e);return t?t.default||t:null}_mergeWithSharedValues(e,t){if("object"!=typeof e||"object"!=typeof t)return t||e;const n={...e};for(const[r,i]of Object.entries(t))Array.isArray(i)&&Array.isArray(e[r])?n[r]=e[r]:n[r]=i;return n}_getValueByPath(e){return e.split(".").reduce(((e,t)=>e&&e[t]),this._config)}}var t=ConfigGetter.getInstance();const n={initEventList:{"graph-ui-ready":!1,"phone-ui-ready":!1,"target-ui-ready":!1,"url-loaded":!1},isMobile:window.innerWidth<1e3,init(e){this.coreAPI=e,this._bindCoreInit(),this._bindInterfaceInit(),window.addEventListener("resize",this._updateUI.bind(this))},dispatchInitEvent(e){this.initEventList[e]||(this.initEventList[e]=!0,Object.values(this.initEventList).every((e=>e))&&this.dispatchEvent("init-ready"))},dispatchEvent(e,t){const n=new CustomEvent(`core:${e}`,{detail:t});window.dispatchEvent(n)},_bindCoreInit(){window.addEventListener("DOMContentLoaded",(async()=>{document.documentElement.toggleAttribute("data-mobile",this.isMobile),this._updateTheme(),this.coreAPI.URLProvider.init(this),await this.coreAPI.MetadataParser.init(this),this.coreAPI.DataProvider.init(this)}))},_bindInterfaceInit(){window.addEventListener("core:init-ready",(async()=>{this.coreAPI.MenuState.init(this),this.coreAPI.RenderEngine.init(this,this.coreAPI.DataProvider),this._addInitialData(),this.coreAPI.CoreExtension.init(),this.dispatchEvent("ready")}))},_updateUI(){this.isMobile!==window.innerWidth<1e3&&(this.isMobile=!this.isMobile,document.documentElement.toggleAttribute("data-mobile",this.isMobile),this.dispatchEvent("ui-mode-change",{isMobile:this.isMobile}))},_updateTheme(){var e=t.get("INTERFACE.PREFERRED_DARK_MODE_THEME")?.toLowerCase()||"system";"system"===e&&(e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme",e)},_addInitialData(){const e=this.coreAPI.URLProvider.getPhoneDataFromURL();if(null!==e)Array.from(e).forEach((async e=>{try{const t=this.coreAPI.MetadataParser.searchFRInfoWithFullName(e);await this.coreAPI.DataProvider.addFRData("phone",t.identifier,{dispSuffix:t.dispSuffix})}catch(t){this.coreAPI.MetadataParser.isTargetAvailable(e)&&await this.coreAPI.DataProvider.addFRData("target",e)}}));else{(t.get("INITIAL_PHONES")||[]).forEach((async e=>{const t=this.coreAPI.MetadataParser.searchFRInfoWithFullName(e);await this.coreAPI.DataProvider.addFRData("phone",t.identifier,{dispSuffix:t.dispSuffix})}));(t.get("INITIAL_TARGETS")||[]).forEach((async e=>{const t=e.includes(" Target")?e:e+" Target";this.coreAPI.MetadataParser.isTargetAvailable(t)&&await this.coreAPI.DataProvider.addFRData("target",t)}))}}},r={activeExtensionList:[],extensionInstances:new Map,async init(){await this.loadExtensionList()},async loadExtensionList(){const e=await this.loadConfiguration();this.activeExtensionList=e.filter((e=>e.ENABLED));for(const e of this.activeExtensionList)await this.loadExtension(e)},async loadExtension(e){try{if(!this.validateExtensionConfig(e))throw new Error(`Invalid extension configuration for ${e.NAME}`);const t=new((await import(`./extensions/${e.NAME}/main.js`)).default)(e.CONFIG);this.extensionInstances.set(e.NAME,t),await(t.init?.()),console.log(`modernGraphTool: extension loaded - ${e.NAME}`)}catch(t){console.error(`modernGraphTool: Failed to load extension: ${e.NAME} -`,t)}},validateExtensionConfig:e=>e.NAME&&"string"==typeof e.NAME,async unloadExtension(e){const t=this.extensionInstances.get(e);t&&(await(t.destroy?.()),this.extensionInstances.delete(e))},getExtension(e){return this.extensionInstances.get(e)},async loadConfiguration(){try{const{EXTENSION_CONFIG:e}=await import(import.meta.resolve("./extensions/extensions.config.js"));return e}catch(e){return console.error("modernGraphTool: Failed to load extension configuration -",e),[]}}},i={_standardFrequencies:function(){const e=[20],t=Math.pow(2,1/48);for(;e[e.length-1]<2e4;)e.push(e[e.length-1]*t);return e}(),async getFRDataFromFile(e,t){const n="phone"===e,r=n?["L","R"]:["AVG"],i={};return await Promise.all(r.map((async e=>{const r=n?t[e]:t;try{const t=await this._fetchFRTextData(n?"phone":"target",r);t&&(i[e]=await this.parseFRData(t))}catch(t){console.error(`Failed to process ${r} ${e} channel:`,t)}}))),n&&i.L&&i.R&&(i.AVG={data:i.L.data.map((([e,t],n)=>[e,(t+i.R.data[n][1])/2])),metadata:{...i.L.metadata}}),i},async getFRDataFromMetadata(e,t,n=""){try{if(""===n)return await i.getFRDataFromFile(e,t.files[0].fileName);{const r=t.files.find((e=>e.suffix===n));if(!r)throw new Error(`No file found with suffix: ${n}`);return await i.getFRDataFromFile(e,r.fileName)}}catch(e){throw new Error("Invalid FR file type: ",e)}},async parseFRData(e){const t=e.split("\n").map((e=>e.trim())).filter((e=>e&&!e.startsWith("#"))).reduce(((e,t,n)=>{const r=t.split(/[\s,]+/).filter((e=>""!==e));if(r.length<2||isNaN(r[0])||isNaN(r[1]))return e;const i=this._parseFrequency(r[0]),a=parseFloat(r[1]),o=r[2]?parseFloat(r[2]):null;return this._isValidDataPoint(i,a)&&(e.data.push([i,a]),null!==o&&e.metadata.weights.push(o)),e}),{data:[],metadata:{weights:[],minFreq:1/0,maxFreq:-1/0}});return 0!==t.data.length&&(t.data.sort(((e,t)=>e[0]-t[0])),t.data=this._interpolateToStandard(t.data),t.metadata.minFreq=this._standardFrequencies[0],t.metadata.maxFreq=this._standardFrequencies[this._standardFrequencies.length-1]),t},async _fetchFRTextData(e,n){const r="phone"===e?`${t.get("PATH.PHONE_MEASUREMENT")}`+(t.get("PATH.PHONE_MEASUREMENT").endsWith("/")?"":"/")+`${n}`:`${t.get("PATH.TARGET_MEASUREMENT")}`+(t.get("PATH.TARGET_MEASUREMENT").endsWith("/")?"":"/")+`${n}`;try{const e=await fetch(r);return e.ok?await e.text():null}catch(t){return console.error(`Failed to load ${e}: ${n}`,t),null}},_parseFrequency(e){const t=parseFloat(e);return e.toLowerCase().includes("k")?1e3*t:t},_interpolateToStandard(e){return this._standardFrequencies.map((t=>{const n=e.findIndex((([e])=>e>t));if(-1===n)return[t,e[e.length-1][1]];if(0===n)return[t,e[0][1]];{const[r,i]=e[n-1],[a,o]=e[n];return[t,i+(o-i)*((t-r)/(a-r))]}}))},_isValidDataPoint:(e,t)=>Number.isFinite(e)&&Number.isFinite(t)&&e>=20&&e<=2e4&&t>=-40&&t<=120};class FRNormalizer{constructor(){this.typeList=["Hz","Avg"],this.type=t.get("NORMALIZATION.TYPE")||"Hz",this.Hzvalue=t.get("NORMALIZATION.HZ_VALUE")||500}init(e){this.dataProvider=e}normalize(e){if(!e?.data?.length)throw console.error("Invalid FR data:",e),new Error("Cannot normalize - invalid data structure");const t=this._deepCopy(e);try{return"Hz"===this.type?this._normalizeByHz(t,this.Hzvalue):this._normalizeByAvg(t,0)}catch(t){return console.error("Normalization failed:",t),e}}async updateNormalization(){const e=new Map,t=Array.from(this.dataProvider.getFRDataMap());(await Promise.all(t.map((async([e,t])=>{try{const n=this.getNormalizedData(t.channels);return[e,{...t,channels:"target"===t.type?{...n.AVG&&{AVG:n.AVG}}:{...n.L&&{L:n.L},...n.R&&{R:n.R},...n.AVG&&{AVG:n.AVG}},dispChannel:[...t.dispChannel]}]}catch(n){return console.error("Failed to re-normalize",e,n),[e,t]}})))).forEach((([t,n])=>e.set(t,n))),this.dataProvider.frDataMap=e,n.dispatchEvent("fr-normalized")}getNormalizedData(e){const t={};for(const n of["L","R","AVG"])if(e[n]){const r=this.normalize(e[n]);t[n]=r}return t}updateNormalizationType(e){if(!this.typeList.includes(e))throw Error("Wrong Type");this.type=e}updateNormalizationValue(e,t){if(!this.typeList.includes(e))throw Error("Wrong Type");"dB"===e?this.dBvalue=Math.max(0,Math.min(100,t)):this.Hzvalue=Math.max(20,Math.min(2e4,t))}_normalizeByDB(e,t){const n=Math.max(-40,Math.min(120,t)),r=n-this._calculateAverageDB(e.data);return e.data.forEach((e=>{e[1]=this._clampDB(e[1]+r)})),e.metadata.normalizedToDB=n,e}_normalizeByHz(e,t){const n=Math.max(20,Math.min(2e4,t)),r=this._findNearestFrequency(e.data,n);if(!r)throw new Error(`No data near ${t}Hz`);const i=-r[1];return e.data.forEach((e=>{e[1]=this._clampDB(e[1]+i)})),e.metadata.normalizedToHz=n,e}_normalizeByAvg(e,t){const n=e.data.filter((e=>e[0]>=300&&e[0]<=3e3));if(n.length<3)throw new Error("Insufficient midrange data for normalization");const r=t-n.reduce(((e,t)=>e+t[1]),0)/n.length;return e.data.forEach((e=>{e[1]=this._clampDB(e[1]+r)})),e.metadata.normalizedToDB=t,e}_deepCopy(e){return JSON.parse(JSON.stringify(e))}_clampDB(e){return Math.max(-40,Math.min(120,Number(e.toFixed(2))))}_calculateAverageDB(e){const t=e.map((e=>e[1])).sort(((e,t)=>e-t)),n=Math.floor(.1*t.length),r=t.slice(n,-n);return r.reduce(((e,t)=>e+t),0)/r.length}_findNearestFrequency(e,t){const n=e.findIndex((e=>e[0]>=t));if(-1===n)return e[e.length-1];if(0===n)return e[0];const[r,i]=e[n-1],[a,o]=e[n],s=(Math.log(t)-Math.log(r))/(Math.log(a)-Math.log(r));return[t,i+s*(o-i)]}static getInstance(){return FRNormalizer.instance||(FRNormalizer.instance=new FRNormalizer),FRNormalizer.instance}}var a=FRNormalizer.getInstance();const o={init(e){this.renderEngine=e,this._bindRenderEvent()},_bindRenderEvent(){window.addEventListener("core:fr-phone-added",(e=>{this.renderEngine.drawFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-phone-removed",(e=>{this.renderEngine.eraseFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-target-added",(e=>{this.renderEngine.drawFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-target-removed",(e=>{this.renderEngine.eraseFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-unknown-inserted",(e=>{this.renderEngine.drawFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-unknown-removed",(e=>{this.renderEngine.eraseFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-normalized",(()=>{this.renderEngine.refreshEveryFRCurves()})),window.addEventListener("core:fr-channel-updated",(e=>{this.renderEngine.channelUpdateRunner(e.detail.uuid,e.detail.type),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-color-updated",(e=>{this.renderEngine.drawFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-dash-updated",(e=>{this.renderEngine.drawFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-variant-updated",(e=>{this.renderEngine.drawFRCurve(e.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-smoothing-updated",(()=>{a.updateNormalization()})),window.addEventListener("core:fr-visibility-updated",(()=>{this.renderEngine.updateLabels()}))}},s={OCTAVE_BANDS:{"1/48":1/48,"1/24":1/24,"1/12":1/12,"1/6":1/6,"1/3":1/3},currentSmoothValue:"1/48",getSmoothDataForPath(e){return this.OCTAVE_BANDS[this.currentSmoothValue]&&e?this._smoothChannel(e,this.currentSmoothValue):e},smooth(e){if(!this.OCTAVE_BANDS[this.currentSmoothValue])return e;const t={};for(const n of["L","R","AVG"])if(e[n]){const r=this._smoothChannel(e[n].data,this.currentSmoothValue);t[n]={...e[n],data:r}}return t},async updateSmoothing(e=null){null!==e&&(this.currentSmoothValue=e),n.dispatchEvent("fr-smoothing-updated")},_smoothChannel(e,t){const n=this._createOctaveBands(t);return this._binData(e,n).map((e=>[e.centerFreq,e.values.reduce(((e,t)=>e+t),0)/e.values.length]))},_createOctaveBands(e){const t=[];let n=20;const r=this.OCTAVE_BANDS[e];for(;n<2e4;){const e=n*Math.pow(2,r);t.push({lower:n,upper:e,centerFreq:Math.sqrt(n*e)}),n=e}return t},_binData:(e,t)=>t.map((t=>({...t,values:e.filter((e=>e&&e[0]>=t.lower&&e[0]<=t.upper)).map((e=>e[1]))}))).filter((e=>e.values.length>0))};class GraphHandle{constructor(e,t){this.svg=e,this.renderEngine=t,this.yShift=0,this.maxShift=20,this.isMobile=document.documentElement.hasAttribute("data-mobile")||window.innerWidth<1e3,this.handleRadius=this.isMobile?20:10,this._initHandle(),this._setupDragBehavior(),this._attachEventListeners()}_initHandle(){this.handleGroup=this.svg.append("g").attr("class","y-scaler-handle").attr("transform",`translate(${this.renderEngine.graphGeometry.xEnd},0)`),this.handle=this.handleGroup.append("circle").attr("r",this.handleRadius).attr("stroke","var(--gt-color-primary)").attr("stroke-width",2).attr("fill","var(--gt-color-surface-container-highest)").attr("opacity","0.4").attr("cursor","pointer").attr("cy",(this.renderEngine.graphGeometry.yTop+this.renderEngine.graphGeometry.yBottom)/2),this.minY=this.renderEngine.graphGeometry.yTop+this.handleRadius,this.maxY=this.renderEngine.graphGeometry.yBottom-this.handleRadius,this.centerY=(this.minY+this.maxY)/2}_setupDragBehavior(){const e=d3.drag().on("start",(()=>{this.handle.attr("opacity","1")})).on("drag",(e=>{const t=Math.max(this.minY,Math.min(this.maxY,e.y));this.handle.attr("cy",t);const n=(t-this.centerY)/(this.maxY-this.centerY);this.yShift=this.maxShift*n,this._updateGraphPosition()})).on("end",(()=>{this.handle.attr("opacity","0.4")}));this.handle.call(e)}_updateGraphPosition(){this.renderEngine.yScale=d3.scaleLinear().domain([-this.renderEngine.yScaleValue/2+this.yShift,this.renderEngine.yScaleValue/2+this.yShift]).range([this.renderEngine.graphGeometry.yBottom,this.renderEngine.graphGeometry.yTop]),this.renderEngine.updateYAxis(null,!1),this.renderEngine.curveGroup.selectAll(".fr-graph-phone-curve, .fr-graph-target-curve").attr("d",(e=>{const t=d3.line().x((e=>this.renderEngine.xScale(e[0]))).y((e=>this.renderEngine.yScale(e[1]))).curve(d3.curveNatural);return t(e)}))}resetHandle(){this.handle.transition().duration(0).attr("cy",this.centerY),this.yShift=0,this._updateGraphPosition()}_attachEventListeners(){this.handle.on("dblclick touchstart",(e=>{if("touchstart"===e.type){let t=this.handle.property("lastTouch")||0;const n=(new Date).getTime();n-t<=300?(e.preventDefault(),this.resetHandle(),this.handle.property("lastTouch",0)):this.handle.property("lastTouch",n)}else this.resetHandle()})),window.addEventListener("core:ui-mode-change",(e=>{this.isMobile=e.detail.isMobile,this.handleRadius=this.isMobile?20:10,this.handle.attr("r",this.handleRadius),this.minY=this.renderEngine.graphGeometry.yTop+this.handleRadius,this.maxY=this.renderEngine.graphGeometry.yBottom-this.handleRadius,this.centerY=(this.minY+this.maxY)/2,0===this.yShift&&this.handle.attr("cy",this.centerY)}))}}class RenderEngine{constructor(){this.graphGeometry={xStart:15,xEnd:785,yTop:15,yBottom:435},this.labelPosition={BOTTOM_LEFT:{x:60,y:427,anchor:"start",growUp:!0},BOTTOM_RIGHT:{x:740,y:427,anchor:"end",growUp:!0},TOP_LEFT:{x:60,y:60,anchor:"start",growUp:!1},TOP_RIGHT:{x:740,y:60,anchor:"end",growUp:!1}},this.baselineData={uuid:null,identifier:null,channelData:null},this.transitionDuration=300}init(e,n){this.coreEvent=e,this.dataProvider=n,o.init(this),this.yScaleValue=parseInt(t.get("VISUALIZATION.DEFAULT_Y_SCALE"))||60,this.svg=d3.select("#fr-graph").attr("viewBox","0 0 800 450").attr("preserveAspectRatio","xMidYMid meet"),this._setupScales(),this._drawAxis(),this._drawFadeGradient(),this._createCurveGroup(),(e=>{const n={BOTTOM_LEFT:{x:50,y:400,anchor:"start"},BOTTOM_RIGHT:{x:754,y:400,anchor:"end"},TOP_LEFT:{x:50,y:70,anchor:"start"},TOP_RIGHT:{x:754,y:70,anchor:"end"},CENTER:{x:400,y:275,anchor:"middle"}},r=t.get("VISUALIZATION.RIG_DESCRIPTION")||"Measured with IEC 60318-4 (711)";e.append("text").attr("class","rig-description").attr("x",n.TOP_RIGHT.x).attr("y",n.TOP_RIGHT.y-8).attr("font-size","15px").attr("font-weight","500").attr("text-anchor",n.TOP_RIGHT.anchor).attr("fill","#000").attr("opacity","0.3").attr("filter","var(--watermark-text-filter)").text(r);const i=t.get("WATERMARK")||[],a=e.append("g").attr("class","watermark-group").attr("transform","translate(0, 0)");i.forEach((e=>{const t={x:n[e.LOCATION||"MIDDLE"].x+(e.POSITION?e.POSITION.RIGHT-e.POSITION.LEFT:0),y:n[e.LOCATION||"MIDDLE"].y+(e.POSITION?e.POSITION.DOWN-e.POSITION.UP:0),anchor:n[e.LOCATION||"MIDDLE"].anchor};"IMAGE"===e.TYPE?a.append("image").attr("class","watermark-image").attr("x",t.x).attr("y",t.y).attr("width",e.SIZE||"100px").attr("opacity",e.OPACITY||"0.3").attr("href",Array.isArray(e.CONTENT)?e.CONTENT[Math.floor(Math.random()*e.CONTENT.length)]:e.CONTENT||""):"TEXT"===e.TYPE&&a.append("text").attr("class","watermark-text").attr("x",t.x).attr("y",t.y).attr("font-size",e.SIZE||"20px").attr("font-weight",e.FONT_WEIGHT||"500").attr("font-family",e.FONT_FAMILY||"").attr("text-anchor",t.anchor).attr("fill",e.COLOR||"#000").attr("opacity",e.OPACITY||"0.3").attr("filter","var(--watermark-text-filter)").text(Array.isArray(e.CONTENT)?e.CONTENT[Math.floor(Math.random()*e.CONTENT.length)]:e.CONTENT||"")}))})(this.svg),this.graphHandle=new GraphHandle(this.svg,this)}refreshEveryFRCurves(){this._updateCurveTimeout&&clearTimeout(this._updateCurveTimeout),this._updateCurveTimeout=setTimeout((()=>{this.svg.select(".fr-graph-curve-container").selectAll("*").remove(),Array.from(this.dataProvider.getFRDataMap()).forEach((([e,t])=>{this.drawFRCurve(e)})),this.orderOverlayLayers(),this._updateCurveTimeout=null}),100)}updateYScale(e){this.yScaleValue=parseInt(e),this._setupScales(),this.graphHandle.resetHandle(),this.updateYAxis(),this.curveGroup.selectAll("*").transition().duration(this.transitionDuration).attr("d",(e=>{const t=d3.line().x((e=>this.xScale(e[0]))).y((e=>this.yScale(e[1]))).curve(d3.curveNatural);return t(e)}))}updateLabels(){this._updateLabelTimeout&&clearTimeout(this._updateLabelTimeout),this._updateLabelTimeout=setTimeout((()=>{var e=0;const n=t.get("VISUALIZATION.LABEL.LOCATION")||"BOTTOM_LEFT",r=this.labelPosition[n].x+parseInt(t.get("VISUALIZATION.LABEL.POSITION.RIGHT")||0)-parseInt(t.get("VISUALIZATION.LABEL.POSITION.LEFT")||0),i=this.labelPosition[n].y+parseInt(t.get("VISUALIZATION.LABEL.POSITION.DOWN")||0)-parseInt(t.get("VISUALIZATION.LABEL.POSITION.UP")||0),a=parseInt(t.get("VISUALIZATION.LABEL.TEXT_SIZE")||17)+8;this.labelBgGroup&&this.labelBgGroup.remove(),this.labelBgGroup=this.svg.append("g").attr("class","fr-graph-label-bg").attr("transform",`translate(${r},${i})`),this.labelGroup&&this.labelGroup.remove(),this.labelGroup=this.svg.append("g").attr("class","fr-graph-label").attr("transform",`translate(${r},${i})`),Array.from(this.dataProvider.frDataMap).sort((([,e],[,t])=>"target"===e.type?-1:1)).forEach((([o,s])=>{if(s.hidden)return;(s.dispChannel||[""]).forEach((r=>{const i="target"!==s.type?`${s.identifier} ${s.dispSuffix} (${r})`:`${s.identifier} ${s.dispSuffix}`;this.labelBgGroup.append("rect").attr("class","fr-graph-label-bg-rect").attr("x",-10).attr("y",""+(e-.75)*a).attr("rx",4).attr("ry",4).attr("width",i.length*a*.35).attr("height",a).attr("fill","var(--gt-color-surface-container-lowest)").attr("opacity","0.7").attr("filter","blur(4px)"),this.labelGroup.append("text").attr("class","fr-graph-label-text").attr("y",""+e*a).attr("fill",s.colors[r]||s.colors?.AVG).attr("style",this.labelPosition[n].style).attr("text-anchor",this.labelPosition[n].anchor).attr("font-size",t.get("VISUALIZATION.LABEL.TEXT_SIZE")||"20px").attr("font-weight",t.get("VISUALIZATION.LABEL.TEXT_WEIGHT")||600).text(i),e++})),this.labelPosition[n].growUp&&(this.labelGroup.attr("transform",`translate(${r}, ${i-e*a})`),this.labelBgGroup.attr("transform",`translate(${r}, ${i-e*a})`))})),this._updateLabelTimeout=null}),0)}updateBaselineData(e,{uuid:t=null,channelData:n=null}){if(e){if(null===t)return void console.error("Baseline UUID is not defined");const e=this.dataProvider.getFRData(t);this.baselineData={uuid:t,identifier:e.identifier,channelData:null!==n?n:"phone"===e.type?e.channels[e.dispChannel.includes("L")&&e.dispChannel.includes("R")?"AVG":e.dispChannel[0]]?.data:e.channels.AVG.data}}else this.baselineData={uuid:null,identifier:null,channelData:null};this.updateBaseline(!0),this.updateBaselineLabel()}updateBaseline(e=!1){const t=this;this.curveGroup.selectAll("*").transition().duration(e?this.transitionDuration:0).attrTween("d",(function(e){const n=d3.select(this).attr("d"),r=t._getCompensatedPath(e);return e=>d3.interpolateString(n,r)(e)})),this.coreEvent.dispatchEvent("fr-baseline-updated",{baselineUUID:this.baselineData.uuid,baselineIdentifier:this.baselineData.identifier})}updateBaselineLabel(){const e=this.baselineData.uuid,n=this.baselineData.identifier;if(null===e)this.svg.selectAll(".fr-graph-baseline-text").remove();else if(!this.svg.selectAll(`.fr-graph-baseline-text[data-uuid='${e}']`).size()){const r=t.get("VISUALIZATION.BASELINE_LABEL.LOCATION")||"BOTTOM_LEFT",i=this.labelPosition[r].x+parseInt(t.get("VISUALIZATION.BASELINE_LABEL.POSITION.RIGHT")||0)-parseInt(t.get("VISUALIZATION.BASELINE_LABEL.POSITION.LEFT")||0),a=this.labelPosition[r].y+parseInt(t.get("VISUALIZATION.BASELINE_LABEL.POSITION.DOWN")||0)-parseInt(t.get("VISUALIZATION.BASELINE_LABEL.POSITION.UP")||0);this.svg.append("text").attr("class","fr-graph-baseline-text").attr("data-uuid",e).attr("x",i).attr("y",a-8).attr("text-anchor",this.labelPosition[r].anchor).attr("fill","#000000").attr("opacity","0.3").attr("font-size",t.get("VISUALIZATION.BASELINE_LABEL.TEXT_SIZE")||"15px").attr("font-weight",t.get("VISUALIZATION.BASELINE_LABEL.TEXT_WEIGHT")||"500").text(`${n} Compensated`)}}_getCompensatedPath(e){const t=d3.bisector((e=>e[0])).left,n=Array.isArray(this.baselineData.channelData)&&this.baselineData.channelData.length>0;return d3.line().x((e=>this.xScale(e[0]))).y((e=>{if(!n)return this.yScale(e[1]);const r=t(this.baselineData.channelData,e[0],0),i=this.baselineData.channelData[r-1],a=this.baselineData.channelData[r];let o=0;if(i&&a){const t=(e[0]-i[0])/(a[0]-i[0]);o=i[1]+t*(a[1]-i[1])}else i?o=i[1]:a&&(o=a[1]);return this.yScale(e[1]-o)})).curve(d3.curveNatural)(e)}getBaselineData(){return this.baselineData}orderOverlayLayers(){this.svg.selectAll(".fr-graph-x-axis, .fr-graph-y-axis").lower(),this.svg.selectAll(".fr-graph-curve-container").raise(),this.svg.selectAll(".x-grid-text, .y-grid-text").raise(),this.svg.selectAll(".fr-graph-label, .fr-graph-label-bg").raise()}_setupScales(){this.xScale=d3.scaleLog().domain([20,2e4]).range([this.graphGeometry.xStart,this.graphGeometry.xEnd]),this.yScale=d3.scaleLinear().domain([-this.yScaleValue/2,this.yScaleValue/2]).range([this.graphGeometry.yBottom,this.graphGeometry.yTop])}getScales(){return{xScale:this.xScale,yScale:this.yScale}}_drawAxis(){this.svg.select(".fr-graph-x-axis").empty()&&this.svg.append("g").attr("class","fr-graph-x-axis").attr("transform","translate(0,0)"),this.svg.select(".fr-graph-y-axis").empty()&&this.svg.append("g").attr("class","fr-graph-y-axis").attr("transform","translate(0,0)"),this.updateXAxis(),this.updateYAxis()}_createCurveGroup(){this.svg.select(".fr-graph-curve-container").empty()&&(this.curveGroup=this.svg.append("g").attr("class","fr-graph-curve-container").attr("transform","translate(0,0)").attr("fill","none").attr("mask","url(#blur-fade-mask)"))}drawFRCurve(e){this.eraseFRCurve(e);const t=this.dataProvider.getFRData(e);"phone"===t.type?this._drawPhoneCurve(t):"target"===t.type?this._drawTargetCurve(t):this._drawUnknownCurve(t)}_drawPhoneCurve(e){[...e.dispChannel].forEach((n=>{d3.line().x((e=>this.xScale(e[0]))).y((e=>this.yScale(e[1]))).curve(d3.curveNatural),this.curveGroup.append("path").datum((()=>s.getSmoothDataForPath(e.channels[n].data))).attr("class","fr-graph-phone-curve").attr("uuid",e.uuid).attr("type",e.type).attr("brand",e.brand).attr("channel",n).attr("identifier",e.identifier).attr("stroke",`${e.colors[n]||e.colors.AVG}`).attr("stroke-width",t.get("TRACE_STYLING.PHONE_TRACE_THICKNESS")||2).attr("stroke-dasharray",e.dash||"1 0").attr("d",(e=>this._getCompensatedPath(e)))}))}_drawTargetCurve(e){d3.line().x((e=>this.xScale(e[0]))).y((e=>this.yScale(e[1]))).curve(d3.curveNatural),this.curveGroup.append("path").datum(e.channels.AVG.data).attr("class","fr-graph-target-curve").attr("uuid",e.uuid).attr("type",e.type).attr("brand",e.brand).attr("identifier",e.identifier).attr("stroke",`${e.colors.AVG||"#666"}`).attr("stroke-width",t.get("TRACE_STYLING.TARGET_TRACE_THICKNESS")||1).attr("stroke-dasharray",e.dash||"4 4").attr("d",(e=>this._getCompensatedPath(e)))}_drawUnknownCurve(e){[...e.dispChannel].forEach((n=>{d3.line().x((e=>this.xScale(e[0]))).y((e=>this.yScale(e[1]))).curve(d3.curveNatural),this.curveGroup.append("path").datum((()=>s.getSmoothDataForPath(e.channels[n].data))).attr("class",`fr-graph-${e.type}-curve`).attr("uuid",e.uuid).attr("type",e.type).attr("channel",n).attr("identifier",e.identifier).attr("stroke",`${e.colors[n]||e.colors.AVG}`).attr("stroke-width","inserted-target"===e.type?t.get("TRACE_STYLING.TARGET_TRACE_THICKNESS")||1:t.get("TRACE_STYLING.PHONE_TRACE_THICKNESS")||2).attr("stroke-dasharray",e.dash||"1 0").attr("d",(e=>this._getCompensatedPath(e)))}))}eraseFRCurve(e){this.curveGroup.selectAll(`*[uuid="${e}"]`).remove()}updateXAxis(e=!0){const t=new Set([80,300,1e3,4e3,6e3,1e4]),n=this.svg.select(".fr-graph-x-axis").selectAll(".x-grid-group").data([20,30,40,50,60,70,80,100,200,300,400,500,600,800,1e3,2e3,3e3,4e3,5e3,6e3,8e3,1e4,15e3,2e4],(e=>e));n.exit().transition().duration(e?this.transitionDuration:0).style("opacity",0).remove();const r=n.enter().append("g").attr("class","x-grid-group").attr("transform",(e=>`translate(${this.xScale(e)},0)`)).style("opacity",0);this._createXAxisElements(r,t);r.merge(n).transition().duration(e?this.transitionDuration:0).style("opacity",1).attr("transform",(e=>`translate(${this.xScale(e)},0)`)),this.orderOverlayLayers()}_createXAxisElements(e,t){e.append("line").attr("class",(e=>t.has(e)?"x-grid-line-major":"x-grid-line")).attr("x1",0).attr("x2",0).attr("y1",this.graphGeometry.yBottom).attr("y2",this.graphGeometry.yTop).attr("stroke",(e=>20===e||2e4===e||t.has(e)?"var(--gt-graph-grid-major)":"var(--gt-graph-grid-minor)")).attr("stroke-width",(e=>20===e||2e4===e||t.has(e)?1:.5)),e.append("text").attr("class",(e=>t.has(e)?"x-grid-text-major":"x-grid-text")).attr("x",0).attr("y",this.graphGeometry.yBottom).attr("dy","11").attr("font-size","0.6rem").attr("font-weight",(e=>t.has(e)?"500":"300")).attr("text-anchor","middle").attr("fill","var(--gt-graph-grid-text)").text((e=>e>=1e3?e/1e3+"k":e))}updateYAxis(e=null,t=!0){const n=this.yScale,r=this.yScaleValue<60?n.ticks(this.yScaleValue):n.ticks(this.yScaleValue/5),i=this.svg.select(".fr-graph-y-axis"),a=i.selectAll(".y-grid-group").data(r,(e=>e));a.exit().transition().duration(t?this.transitionDuration:0).style("opacity",0).remove();const o=a.enter().append("g").attr("class","y-grid-group").attr("y",(e=>e)).style("opacity",0);this._createYAxisElements(o,e||n);const s=o.merge(a);s.transition().duration(t?this.transitionDuration:0).style("opacity",1),s.selectAll(".y-grid-line, .y-grid-line-major").transition().duration(t?this.transitionDuration:0).attr("y1",(e=>n(e))).attr("y2",(e=>n(e))),s.selectAll(".y-grid-text").transition().duration(t?this.transitionDuration:0).attr("y",(e=>n(e)));let l=i.select(".y-grid-db-text");l.empty()&&(l=i.append("text").attr("class","y-grid-db-text").attr("transform","rotate(-90)").text("dB")),l.attr("x",-31).attr("y",15).attr("dx",4).attr("dy",-4).attr("font-size","0.6rem").attr("font-weight","400").attr("text-anchor","start").attr("fill","var(--gt-graph-grid-text)"),this.orderOverlayLayers()}_createYAxisElements(e,t){e.append("line").attr("class",(e=>e%10==0?"y-grid-line":"y-grid-line-major")).attr("x1",this.graphGeometry.xStart).attr("x2",this.graphGeometry.xEnd).attr("y1",(e=>t(e))).attr("y2",(e=>t(e))).attr("stroke",(e=>e%10==0?"var(--gt-graph-grid-major)":"var(--gt-graph-grid-minor)")).attr("stroke-width",(e=>e%10==0?1:.7)),e.each(((e,n,r)=>{e%10==0&&d3.select(r[n]).append("text").attr("class","y-grid-text").attr("x",this.graphGeometry.xStart).attr("y",t(e)).attr("dx",4).attr("dy",-4).attr("font-size","0.6rem").attr("font-weight","400").attr("text-anchor","start").attr("fill","var(--gt-graph-grid-text)").text(e)}))}_drawFadeGradient(){this.svg.append("defs").append("mask").attr("id","blur-fade-mask").append("rect").attr("x",20).attr("y",20).attr("width",760).attr("height",410).attr("fill","white").attr("filter","blur(5px)")}channelUpdateRunner(e,t){this.curveGroup.selectAll(`.fr-graph-${t}-curve[uuid="${e}"]`).remove(),"phone"===t?this._drawPhoneCurve(this.dataProvider.getFRData(e)):this._drawUnknownCurve(this.dataProvider.getFRData(e))}static getInstance(){return RenderEngine.instance||(RenderEngine.instance=new RenderEngine),RenderEngine.instance}}var l=RenderEngine.getInstance();const d={phoneMetadata:null,targetMetadata:null,async init(e){this.coreEvent=e,this.phoneMetadata||(this.phoneMetadata=await this._fetchBookObject()),this.targetMetadata||(this.targetMetadata=this._fetchTargetObject()),this.coreEvent.dispatchEvent("metadata-loaded")},isPhoneAvailable(e){return this.phoneMetadata.some((t=>t.phones.some((t=>t.identifier===e))))||this.phoneMetadata.some((t=>t.phones.some((n=>n.files.some((r=>{if(r.fullName)return r.fullName===e;const i=Array.isArray(n.name)?n.name[0]:n.name;return t.name+" "+i+" "+(n.prefix?r.replace(n.prefix,"").trim():"")===e}))))))},isTargetAvailable(e){return this.targetMetadata.some((t=>t.files.some((t=>(t.includes(" Target")?t:`${t} Target`)===(e.includes(" Target")?e:`${e} Target`)))))},getFRMetadata(e,t){if("phone"===e){for(const e of this.phoneMetadata){const n=e.phones.find((e=>e.identifier===t));if(n)return n}return this.searchFRInfoWithFullName(t)}return"target"===e?{identifier:t,files:[{fileName:`${t}.txt`}]}:{identifier:t}},searchFRInfoWithFullName(e){for(const t of this.phoneMetadata)for(const n of t.phones){for(const t of n.files)if(t.fullName.toLowerCase()===e.toLowerCase())return{...n,dispSuffix:t.suffix||""};if(n.identifier.toLowerCase()===e.toLowerCase())return{...n,dispSuffix:n.files[0].suffix}}throw new Error(`No such data found: ${e}`)},async _fetchBookObject(){return(await fetch(t.get("PATH.PHONE_BOOK")||"../../../data/phone_book.json").then((e=>e.json()))).map((e=>{const t=[e.name,e.suffix].filter(Boolean).join(" ");return{brand:t,phones:e.phones.map((e=>{const n={brand:t,...e.reviewScore&&{reviewScore:e.reviewScore},...e.reviewLink&&{reviewLink:e.reviewLink},...e.shopLink&&{shopLink:e.shopLink},...e.price&&{price:e.price}};if("string"==typeof e)return{...n,name:e,identifier:t+" "+e,files:[{suffix:this._getSuffix(e,0),fullName:(t+" "+e+" "+this._getSuffix(e,0)).trim(),fileName:{L:e+" L.txt",R:e+" R.txt"}}]};const r=Array.isArray(e.name)?e.name[0]:e.name;return{...n,name:r,identifier:t+" "+r,files:Array.isArray(e.file)?e.file.map(((n,i)=>({suffix:this._getSuffix(e,i),fullName:(t+" "+r+" "+this._getSuffix(e,i)).trim(),fileName:{L:`${n} L.txt`,R:`${n} R.txt`}}))):[{suffix:this._getSuffix(e,0),fullName:(t+" "+r+" "+this._getSuffix(e,0)).trim(),fileName:{L:`${e.file} L.txt`,R:`${e.file} R.txt`}}]}}))}}))},_fetchTargetObject:()=>t.getDefault("TARGET_MANIFEST").map((e=>({type:e.type,files:e.files.map((e=>e.includes(" Target")?e:`${e} Target`))})))||[],_getSuffix:(e,t=null)=>Array.isArray(e.file)?Array.isArray(e.suffix)?e.suffix[t].trim()||t:"string"==typeof e.suffix?e.suffix.trim()||t:Array.isArray(e.prefix)?e.file[t].replace(new RegExp(e.prefix[t],"i"),"").trim():"string"==typeof e.prefix?e.file[t].replace(new RegExp(e.prefix,"i"),"").trim():"":"string"==typeof e.suffix?e.suffix.trim()||e.file.trim():"string"==typeof e.prefix?e.file.replace(new RegExp(e.prefix,"i"),"").trim():""};class DataProvider{constructor(){this.frDataMap=new Map,this.baseHue=null}init(e){this.coreEvent=e,a.init(this)}async addFRData(e,t,n={}){if(this.isFRDataLoaded(t,n?.dispSuffix||null))return;const r=await d.getFRMetadata(e,t),o=await i.getFRDataFromMetadata(e,r,n?.dispSuffix),l=a.getNormalizedData(o),c=s.smooth(l),h={uuid:crypto.randomUUID(),type:e,identifier:r?.identifier,channels:"phone"===e?{...c.L&&{L:c.L},...c.R&&{R:c.R},...c.AVG&&{AVG:c.AVG}}:{...c.AVG&&{AVG:c.AVG}},dispChannel:this._getChannelValue(e,Object.keys(c)),dispSuffix:r.files.length>1?n?.dispSuffix?n?.dispSuffix:r.files[0]?.suffix:"",colors:this._getColorWithType(e),dash:this._getDashWithType(e,r?.identifier),meta:r};this.frDataMap.set(h.uuid,h),this.coreEvent.dispatchEvent(`fr-${e}-added`,{uuid:h.uuid,identifier:r?.identifier})}removeFRData(e,t){const n=Array.from(this.frDataMap).find((([,e])=>e.identifier===t));if(n){const[t]=n;this.frDataMap.delete(t);const r=["phone","target"].includes(e)?`fr-${e}-removed`:"fr-unknown-removed";this.coreEvent.dispatchEvent(r,{uuid:t,identifier:n[1].identifier})}}async insertRawFRData(e,t,n,r={}){try{const i=a.getNormalizedData(n),o=s.smooth(i),l={uuid:crypto.randomUUID(),type:`inserted-${e}`,identifier:t,channels:Object.keys(o).length>1?{...o.L&&{L:o.L},...o.R&&{R:o.R},...o.AVG&&{AVG:o.AVG}}:{...o.AVG&&{AVG:o.AVG}},dispChannel:r?.dispChannel?r?.dispChannel:this._getChannelValue(e,Object.keys(o)),dispSuffix:r?.dispSuffix?r?.dispSuffix:"(Inserted)",colors:this._getColorWithType(e),dash:this._getDashWithType(e,t)};this.frDataMap.set(l.uuid,l),this.coreEvent.dispatchEvent("fr-unknown-inserted",{uuid:l.uuid,identifier:t})}catch(e){throw new Error("An Error Occurred while adding FR Data")}}removeFRDataWithUUID(e,t){const n=Array.from(this.frDataMap).find((([e])=>e===t));if(n){this.frDataMap.delete(t);const r=["phone","target"].includes(e)?`fr-${e}-removed`:"fr-unknown-removed";this.coreEvent.dispatchEvent(r,{uuid:t,identifier:n[1].identifier})}}getFRData(e){return this.frDataMap.has(e)?structuredClone(this.frDataMap.get(e)):null}getFRDataMap(){return structuredClone(this.frDataMap)}isFRDataLoaded(e,t=""){return""===t?Array.from(this.frDataMap).some((([,t])=>t.identifier===e)):Array.from(this.frDataMap).some((([,n])=>n.identifier===e&&n.dispSuffix===t))}getUUIDwithIdentifier(e){const t=Array.from(this.frDataMap).find((([,t])=>t.identifier===e));if(t){const[e]=t;return e}return""}getLoadedFRIdentifierBySource(e){return Array.from(this.frDataMap).filter((([,t])=>t.type===e)).map((([e,t])=>t.identifier))}async toggleFRData(e,t,n){try{n?await this.addFRData(e,t):this.removeFRData(e,t)}catch(e){throw new Error("An Error Occurred while toggling FR Data")}}async updateVariant(e,t){const n=this.getFRData(e);if(!n)throw new Error("No data found for UUID:",e);try{const r=await i.getFRDataFromMetadata("phone",n.meta,t),o=a.getNormalizedData(r),l=s.smooth(o);this.frDataMap.set(e,{...n,channels:{...l.L&&{L:l.L},...l.R&&{R:l.R},...l.AVG&&{AVG:l.AVG}},dispSuffix:t,dispChannel:n.dispChannel.every((e=>Object.keys(l).includes(e)))?n.dispChannel:[Object.keys(l)[0]]}),this.coreEvent.dispatchEvent("fr-variant-updated",{uuid:e})}catch(e){throw new Error("An Error Occurred while updating FR Data")}}updateFRDataWithRawData(e,t,{identifier:n=null,dispSuffix:r=null,meta:i=null}={}){if(!this.frDataMap.has(e))throw new Error("No data found for UUID:",e);const o=this.getFRData(e);try{const d=a.getNormalizedData(t),c=s.smooth(d);this.frDataMap.set(e,{...o,channels:"target"===o.type?{...c.AVG&&{AVG:c.AVG}}:{...c.L&&{L:c.L},...c.R&&{R:c.R},...c.AVG&&{AVG:c.AVG}},...null!==n&&{identifier:n},...null!==r&&{dispSuffix:r},...null!==i&&{meta:i}}),l.drawFRCurve(e)}catch(e){console.error("Error updating EQ curve:",e)}}updateMetadata(e,t,n,r){if(!["uuid","identifier"].includes(e))throw new Error("Wrong keyType was given");if(!["dispChannel","colors","dash"].includes(n))throw new Error("Wrong inputType was given");"uuid"!==e&&(t=DataProvider.getUUIDwithIdentifier(t));const i=this.getFRData(t);if(!i)throw new Error("No data found for UUID:",t);if("dispChannel"===n){if(Array.isArray(r))i.dispChannel=r,this.frDataMap.set(t,i);else{if("L"!==r&&"R"!==r&&"AVG"!==r)throw Error("Wrong Channel Data was given");i.dispChannel=[r],this.frDataMap.set(t,i)}this.coreEvent.dispatchEvent("fr-channel-updated",{uuid:t,type:i.type})}else"colors"===n?(i.colors.L=r.L||"",i.colors.R=r.R||"",i.colors.AVG=r.AVG||"",this.frDataMap.set(t,i),this.coreEvent.dispatchEvent("fr-color-updated",{uuid:t})):"dash"===n&&(i.dash=r,this.frDataMap.set(t,i),this.coreEvent.dispatchEvent("fr-dash-updated",{uuid:t}))}_getChannelValue(e,t){const n=Array.from(this.frDataMap.values()).filter((e=>"phone"===e.type));return"phone"===e?n.length<1?t.filter((e=>"AVG"!==e)):(n.forEach((e=>{"AVG"!==e.dispChannel[0]&&(Object.keys(e.channels).includes("AVG")?e.dispChannel=["AVG"]:e.dispChannel=Object.keys(e.channels)[0],this.coreEvent.dispatchEvent("fr-channel-updated",{uuid:e.uuid,type:e.type}))})),t.includes("AVG")?["AVG"]:[`${t[0]}`]):["AVG"]}_getColorWithType(e){null===this.baseHue?this.baseHue=parseInt((360*Math.random()).toFixed(0)):this.baseHue=(this.baseHue+100)%360;const t=parseInt((50*Math.random()).toFixed(0)),n=parseInt((20*Math.random()).toFixed(0));return"target"===e?{AVG:`hsl(${this.baseHue}, 0%, 45%)`}:{L:`hsl(${(this.baseHue-5)%360}, ${50+t}%, ${40+n}%)`,R:`hsl(${(this.baseHue+5)%360}, ${50+t}%, ${40+n}%)`,AVG:`hsl(${this.baseHue}, ${50+t}%, ${40+n}%)`}}_getDashWithType(e,n=null){return"target"===e?null===n?this._getRandomDashForTarget():t.get("TRACE_STYLING.TARGET_TRACE_DASH")?.find((e=>(e.name.endsWith(" Target")?e.name:e.name+" Target")===n))?.dash||this._getRandomDashForTarget():"1 0"}_getRandomDashForTarget(){const e=1+Math.floor(3*Math.random()),t=[],n=5+Math.floor(3*Math.random());for(let r=0;r<e;r++)if(r%2==0){const e=5+Math.floor(5*Math.random());t.push(`${e} ${n}`)}else t.push(`2 ${n}`);return t.join(" ")}static getInstance(){return DataProvider.instance||(DataProvider.instance=new DataProvider),DataProvider.instance}}var c=DataProvider.getInstance();class MenuState{constructor(){this.currentMenu=t.get("INITIAL_PANEL")||"phone",this.coreMenuList=["phone","graph","misc"],this.coreMenuBarName=["DEVICES","GRAPH","MISC"],this.extensionMenuList=[]}init(t){this.coreEvent=t,e.addObserver(this._updateLanguage.bind(this)),document.querySelector(`.menu-panel[data-target="${this.currentMenu}-panel"]`)?.classList.add("active"),document.querySelector(`.menu-bar-item[data-target="${this.currentMenu}-panel"]`)?.classList.add("active"),window.addEventListener("core:menu-change",(e=>{this.currentMenu=e.detail.target.replace("-panel","")}))}getMenuList(){return[...this.coreMenuList,...this.extensionMenuList]}getCoreMenuPanels(){var e="";return this.coreMenuList.forEach((t=>{e+=`<${t}-panel></${t}-panel>`})),e}getCoreMenuBarItem(){var t="";return this.coreMenuList.forEach(((n,r)=>{t+=`\n      <button type="button" class="menu-bar-item" data-target="${n}-panel">\n        ${e.getString(`menu.item-${n}-label`,this.coreMenuBarName[r]||"?")}\n      </button>\n      `})),t}addExtensionMenu(t,n,r){const i=t.trim();this.extensionMenuList.push(i);const a=document.createElement("div");a.id=`${i}-panel`,a.className="menu-panel extension-panel",a.setAttribute("data-target",`${i}-panel`),a.innerHTML=r,document.querySelector(".menu-panels").insertBefore(a,document.querySelector("misc-panel"));const o=document.createElement("button");o.className="menu-bar-item",o.setAttribute("type","button"),o.setAttribute("data-target",`${i}-panel`),o.innerHTML=e.getString(`extension.${t}.menu-label`,t.toUpperCase())||n.trim()||"?",document.querySelector(".menu-carousel").insertBefore(o,document.querySelector('.menu-bar-item[data-target="misc-panel"]')),this.coreEvent.dispatchEvent("extension-menu-added")}_updateCarousel(){const e=document.querySelector("menu-carousel");e&&(e._buttons=Array.from(e.querySelectorAll(".menu-bar-item")).filter((e=>"none"!==window.getComputedStyle(e).display)),e._updateCarousel(),e._addEventListener())}_updateLanguage(){this._updateCoreLanguage(),this._updateExtensionLanguage()}_updateCoreLanguage(){this.coreMenuBarName.forEach(((t,n)=>{const r=document.querySelector(`.menu-bar-item[data-target="${this.coreMenuList[n]}-panel"]`);r&&(r.textContent=e.getString(`menu.item-${this.coreMenuList[n]}-label`,t))}))}_updateExtensionLanguage(){this.extensionMenuList.forEach(((t,n)=>{const r=document.querySelector(`.menu-bar-item[data-target="${t}-panel"]`);r&&(r.textContent=e.getString(`extension.${t}.menu-label`,t.toUpperCase()))}))}static getInstance(){return MenuState.instance||(MenuState.instance=new MenuState),MenuState.instance}}var h=MenuState.getInstance();const u={charset:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",encode(e){const t=(new TextEncoder).encode(e);let n=BigInt(0);for(let e=0;e<t.length;e++)n=n*BigInt(256)+BigInt(t[e]);let r="";for(;n>0;)r=this.charset[Number(n%BigInt(62))]+r,n/=BigInt(62);return r||"0"},decode(e){let t=BigInt(0);for(let n=0;n<e.length;n++)t=t*BigInt(62)+BigInt(this.charset.indexOf(e[n]));const n=[];for(;t>0;)n.unshift(Number(t%BigInt(256))),t/=BigInt(256);return(new TextDecoder).decode(new Uint8Array(n))}};var p=new class{constructor(){this.baseTitle=document.querySelector("title")?.textContent||"modernGraphTool",this.baseDescription=document.querySelector('meta[name="description"]')?.getAttribute("content")||"View and compare frequency response graphs",this.baseURL=window.location.href.split("?")[0],this.autoUpdateURL=t.get("URL.AUTO_UPDATE_URL")||!0,this.useBase62=t.get("URL.COMPRESS_URL")||!1,this.currentURL="",this.phoneDataFromURL=null,this._handlePhoneChange=this._handlePhoneChange.bind(this)}init(e){this.coreEvent=e,this._setupEventListeners(),this._loadFromURL()}_setupEventListeners(){window.addEventListener("core:fr-phone-added",this._handlePhoneChange),window.addEventListener("core:fr-phone-removed",this._handlePhoneChange),window.addEventListener("core:fr-target-added",this._handlePhoneChange),window.addEventListener("core:fr-target-removed",this._handlePhoneChange)}_handlePhoneChange(e){this.updateURL(this.autoUpdateURL)}async _loadFromURL(){const e=new URLSearchParams(window.location.search).get("share");let t=null;if(e)if(e.startsWith("b62_")){const n=e.replace("b62_","");t=u.decode(n).split(",")}else t=decodeURI(e).split(",").map((e=>e.replace(/_/g," ")));this.phoneDataFromURL=t,this.coreEvent&&this.coreEvent.dispatchInitEvent("url-loaded")}updateURL(e=!0){const t=Array.from(c.frDataMap).map((([e,t])=>(t.identifier+" "+t.dispSuffix).trim())).filter((e=>e));let n=this.baseTitle,r=this.baseURL;const i=t.join(", ");if(t.length){if(this.useBase62){r+=`?share=b62_${u.encode(t.join(","))}`}else r+=`?share=${encodeURI(t.join(",").replace(/ /g," "))}`;n=n+" - "+i}e&&(window.history.replaceState("",n,r),this.currentURL=r),document.title=n,this._updateMetaTags(i)}_updateMetaTags(e){const t=document.querySelector("link[rel='canonical']");t&&t.setAttribute("href",e?window.location.href:this.baseURL);const n=document.querySelector("meta[name='description']");n&&e&&n.setAttribute("content",`View and compare frequency response graph of ${e}.`)}toggleBase62(e){this.useBase62=e,this.updateURL()}getPhoneDataFromURL(){return this.phoneDataFromURL}getCurrentURL(){return this.currentURL}};const g={CoreEvent:n,CoreExtension:r,DataProvider:c,MenuState:h,RenderEngine:l,MetadataParser:d,StringLoader:e,FRParser:i,FRNormalizer:a,URLProvider:p};var m=Object.freeze({__proto__:null,CoreEvent:n,CoreExtension:r,DataProvider:c,FRNormalizer:a,FRParser:i,MenuState:h,MetadataParser:d,RenderEngine:l,StringLoader:e,URLProvider:p,default:g});const f=new CSSStyleSheet;f.replaceSync('/* Core styles */\nhtml {\n  min-width: 340px;\n  width: 100lvw;\n  height: 100lvh;\n\n  -webkit-user-select: none;\n  user-select: none;\n}\n\nbody {\n  margin: 0;\n  width: 100%;\n  height: 100%;\n  padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);\n  box-sizing: border-box;\n  \n  position: fixed;\n  overflow: hidden;\n  touch-action: none;\n  overscroll-behavior-y: none;\n\n  font-family: \'Interop\', sans-serif;\n  font: var(--gt-typescale-body-medium);\n  color: var(--gt-color-on-surface);\n  background: var(--gt-color-surface-container);\n\n  h1 { font: var(--gt-typescale-title-large); }\n  h2 { font: var(--gt-typescale-title-medium); }\n  h3 { font: var(--gt-typescale-title-small); }\n  input { font: var(--gt-typescale-body-medium); }\n\n  -webkit-tap-highlight-color: transparent;\n}\n\n* {\n  transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),\n              color 0s cubic-bezier(0.4, 0, 0.2, 1),\n              border-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),\n              fill 0.2s cubic-bezier(0.4, 0, 0.2, 1),\n              stroke 0.2s cubic-bezier(0.4, 0, 0.2, 1),\n              box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\nselect {\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  appearance: none;\n  border-radius: 0.5rem;\n  border: 1px solid var(--gt-color-outline);\n  padding-left: 0.6rem;\n  font: var(--gt-typescale-body-medium);\n  color: var(--gt-color-on-surface);\n  background-repeat: no-repeat;\n  background-position: right center;\n  background-color: var(--gt-color-surface-container-lowest);\n  background-image: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23666"><path d="M12 15.0006L7.75732 10.758L9.17154 9.34375L12 12.1722L14.8284 9.34375L16.2426 10.758L12 15.0006Z"></path></svg>\');\n  outline: none;\n  cursor: pointer;\n}\n\nbutton {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: none;\n  background: none;\n  color: var(--gt-color-on-surface);\n  cursor: pointer;\n}\n@media (hover: hover) and (pointer: fine) {\n  button:hover {\n    background: var(--gt-shadow);\n  }\n}\nbutton:active {\n  background: var(--gt-shadow);\n  transition: background 0s;\n}\n\ndiv::-webkit-scrollbar {\n  width: 0.5rem;\n  height: 0.5rem;\n}\ndiv::-webkit-scrollbar-thumb {\n  border-radius: 0.5rem;\n  background-color: rgba(0,0,0,0.2);\n}\n\n@layer aria-busy {\n  *[aria-busy="true"] {\n    pointer-events: none;\n    position: relative;\n    filter: blur(1px);\n    opacity: 0.8 !important;\n    transition: filter 0.5s ease-out;\n  }\n    \n  *[aria-busy="true"]::after {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    animation: shimmer 1.5s infinite;\n    background: linear-gradient(\n      to right,\n      transparent 0%,\n      rgba(0,0,0,0.5) 50%,\n      transparent 100%\n    );\n    opacity: 0.7;\n    transition: opacity 0.3s ease-out;\n  }\n\n  /* Explicitly remove ::after when aria-busy is false/removed */\n  *[aria-busy="false"]::after {\n    content: none;\n    opacity: 0;\n  }\n\n  @keyframes shimmer {\n    0% {\n      transform: translateX(-100%);\n      opacity: 0.4;\n    }\n    50% {\n      opacity: 0.7;\n    }\n    100% {\n      transform: translateX(100%);\n      opacity: 0.4;\n    }\n  }\n}');const v=new CSSStyleSheet;v.replaceSync("@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Light.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Light.woff')\n      format('woff');\n  font-weight: 300;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-ExtraBold.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-ExtraBold.woff')\n      format('woff');\n  font-weight: 800;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Bold.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Bold.woff')\n      format('woff');\n  font-weight: bold;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-ExtraLight.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-ExtraLight.woff')\n      format('woff');\n  font-weight: 200;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Medium.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Medium.woff')\n      format('woff');\n  font-weight: 500;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Regular.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Regular.woff')\n      format('woff');\n  font-weight: normal;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-SemiBold.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-SemiBold.woff')\n      format('woff');\n  font-weight: 600;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Thin.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Thin.woff')\n      format('woff');\n  font-weight: 100;\n  font-style: normal;\n  font-display: block;\n}");class CoreUI extends HTMLElement{constructor(){super(),Promise.resolve().then((function(){return b})),this.innerHTML='\n      <top-nav-bar></top-nav-bar>\n      <section class="main-content">\n        <section class="main-graph">\n          <graph-container></graph-container>\n          <div class="main-graph-list">\n            \x3c!-- selection-list should be positioned here --\x3e\n          </div>\n        </section>\n        <drag-divider></drag-divider>\n        <section class="main-menu">\n          <menu-container></menu-container>\n          <menu-carousel></menu-carousel>\n        </section>\n      </section>\n      <tutorial-modal></tutorial-modal>\n\n      \x3c!-- Styles --\x3e\n      <style>\n        core-ui {\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n        }\n          \n        .main-content {\n          flex: 1;\n          display: grid;\n          grid-template-columns: 65% 5px;\n          position: relative;\n          height: 0;\n        }\n\n        .main-menu {\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          grid-column: 3;\n        }\n\n        .main-graph {\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          grid-column: 1;\n          background: var(--gt-color-surface-container-lowest);\n        }\n\n        :root[data-mobile] {\n          .main-content {\n            display: flex;\n            flex-direction: column;\n          }\n          .main-divider, .main-graph-list {\n            display: none;\n          }\n          .main-menu {\n            flex: 1;\n            background: var(--gt-color-surface);\n            border-radius: 0.5rem 0.5rem 0 0;\n            border-top: 1px solid var(--gt-color-outline);\n          }\n        }\n\n        :root:not([data-mobile]) {\n          .main-menu {\n            min-width: 340px;\n          }\n          .main-graph-list {\n            flex: 1;\n            overflow-y: scroll;\n            padding: 1rem 0.5rem 1rem 1rem;\n            background: var(--gt-color-surface);\n            border-radius: 0.5rem 0.5rem 0 0;\n            border-top: 1px solid var(--gt-color-outline);\n          }\n        }\n      </style>\n    ',document.adoptedStyleSheets=[f,v]}connectedCallback(){n.init(m),this._disableIOSTextFieldZoom(),this.addEventListener("drag-divider-moved",this._handleDividerMove)}disconnectedCallback(){this.removeEventListener("drag-divider-moved",this._handleDividerMove)}_handleDividerMove=e=>{const t=this.querySelector(".main-content"),{width:n,x:r}=t.getBoundingClientRect(),i=(e.detail.currentX-r)/n*100;t.style.gridTemplateColumns=`\n      clamp(400px, ${i}%, calc(100% - 346px))\n      5px \n      minmax(340px, 1fr)\n    `};_disableIOSTextFieldZoom=()=>{if(!this._isIOS())return;const e=document.querySelector("meta[name=viewport]");if(null!==e){let t=e.getAttribute("content"),n=/maximum\-scale=[0-9\.]+/g;t=n.test(t)?t.replace(n,"maximum-scale=1.0"):[t,"maximum-scale=1.0"].join(", "),e.setAttribute("content",t)}};_isIOS=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}customElements.define("core-ui",CoreUI),Promise.resolve().then((function(){return y})),Promise.resolve().then((function(){return w})),Promise.resolve().then((function(){return x})),Promise.resolve().then((function(){return E})),Promise.resolve().then((function(){return _})),Promise.resolve().then((function(){return S})),Promise.resolve().then((function(){return C})),Promise.resolve().then((function(){return T})),Promise.resolve().then((function(){return I})),Promise.resolve().then((function(){return A})),Promise.resolve().then((function(){return M})),Promise.resolve().then((function(){return k})),Promise.resolve().then((function(){return R})),Promise.resolve().then((function(){return D})),Promise.resolve().then((function(){return H})),Promise.resolve().then((function(){return N})),Promise.resolve().then((function(){return O})),Promise.resolve().then((function(){return P})),Promise.resolve().then((function(){return B})),Promise.resolve().then((function(){return $}));var b=Object.freeze({__proto__:null});class PhonePanel extends HTMLElement{constructor(){super(),this.innerHTML='\n    \x3c!-- Phone panel --\x3e\n    <div class="menu-panel" id="phone-panel" data-target="phone-panel">\n      <phone-selector></phone-selector>\n    </div>\n    <style>\n      #phone-panel {\n        padding: 1rem 0 0 0;\n        overflow-y: hidden;\n        scrollbar-gutter: auto;\n      }\n    </style>\n    '}}customElements.define("phone-panel",PhonePanel);var y=Object.freeze({__proto__:null});class GraphPanel extends HTMLElement{constructor(){super(),this.innerHTML='\n    \x3c!-- Graph panel --\x3e\n    <div class="menu-panel" id="graph-panel" data-target="graph-panel">\n      <target-selector style="margin-bottom: 1rem;"></target-selector>\n      <selection-list></selection-list>\n    </div>\n    ',this.graphButtonContainer=document.createElement("div"),this.graphButtonContainer.className="graph-button-container",this.graphButtonContainer.innerHTML="\n      <style>\n        .graph-button-container {\n          display: flex;\n          flex-wrap: wrap;\n          flex-direction: row;\n          align-items: center;\n          justify-content: center;\n          gap: 0.75rem;\n          margin-bottom: 1rem;\n\n          h3 {\n            margin: 0;\n            color: var(--gt-color-on-surface);\n          }\n        }\n      </style>\n      <normalizer-input></normalizer-input>\n      <smoothing-button></smoothing-button>\n      <graph-scale-button></graph-scale-button>\n      <graph-screenshot-button></graph-screenshot-button>\n      <share-button></share-button>\n    ",this._updateUI(),window.addEventListener("core:ui-mode-change",this._updateUI.bind(this))}_updateUI(e=null){if(this.isMobile=e?e.detail.isMobile:window.innerWidth<1e3,this.graphButtonContainer.parentNode&&this.graphButtonContainer.parentNode.removeChild(this.graphButtonContainer),this.isMobile){const e=document.querySelector("#graph-panel");e&&!e.querySelector(".graph-button-container")&&e.appendChild(this.graphButtonContainer)}else{const e=document.querySelector(".main-graph-list");e&&!e.querySelector(".graph-button-container")&&e.appendChild(this.graphButtonContainer)}}}customElements.define("graph-panel",GraphPanel);var w=Object.freeze({__proto__:null});const L={iconPath:{delete:'<path d="M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 11H11V17H9V11ZM13 11H15V17H13V11ZM9 4V6H15V4H9Z"></path>',eyeOn:'<path d="M12.0003 3C17.3924 3 21.8784 6.87976 22.8189 12C21.8784 17.1202 17.3924 21 12.0003 21C6.60812 21 2.12215 17.1202 1.18164 12C2.12215 6.87976 6.60812 3 12.0003 3ZM12.0003 19C16.2359 19 19.8603 16.052 20.7777 12C19.8603 7.94803 16.2359 5 12.0003 5C7.7646 5 4.14022 7.94803 3.22278 12C4.14022 16.052 7.7646 19 12.0003 19ZM12.0003 16.5C9.51498 16.5 7.50026 14.4853 7.50026 12C7.50026 9.51472 9.51498 7.5 12.0003 7.5C14.4855 7.5 16.5003 9.51472 16.5003 12C16.5003 14.4853 14.4855 16.5 12.0003 16.5ZM12.0003 14.5C13.381 14.5 14.5003 13.3807 14.5003 12C14.5003 10.6193 13.381 9.5 12.0003 9.5C10.6196 9.5 9.50026 10.6193 9.50026 12C9.50026 13.3807 10.6196 14.5 12.0003 14.5Z"></path>',eyeOff:'<path d="M17.8827 19.2968C16.1814 20.3755 14.1638 21.0002 12.0003 21.0002C6.60812 21.0002 2.12215 17.1204 1.18164 12.0002C1.61832 9.62282 2.81932 7.5129 4.52047 5.93457L1.39366 2.80777L2.80788 1.39355L22.6069 21.1925L21.1927 22.6068L17.8827 19.2968ZM5.9356 7.3497C4.60673 8.56015 3.6378 10.1672 3.22278 12.0002C4.14022 16.0521 7.7646 19.0002 12.0003 19.0002C13.5997 19.0002 15.112 18.5798 16.4243 17.8384L14.396 15.8101C13.7023 16.2472 12.8808 16.5002 12.0003 16.5002C9.51498 16.5002 7.50026 14.4854 7.50026 12.0002C7.50026 11.1196 7.75317 10.2981 8.19031 9.60442L5.9356 7.3497ZM12.9139 14.328L9.67246 11.0866C9.5613 11.3696 9.50026 11.6777 9.50026 12.0002C9.50026 13.3809 10.6196 14.5002 12.0003 14.5002C12.3227 14.5002 12.6309 14.4391 12.9139 14.328ZM20.8068 16.5925L19.376 15.1617C20.0319 14.2268 20.5154 13.1586 20.7777 12.0002C19.8603 7.94818 16.2359 5.00016 12.0003 5.00016C11.1544 5.00016 10.3329 5.11773 9.55249 5.33818L7.97446 3.76015C9.22127 3.26959 10.5793 3.00016 12.0003 3.00016C17.3924 3.00016 21.8784 6.87992 22.8189 12.0002C22.5067 13.6998 21.8038 15.2628 20.8068 16.5925ZM11.7229 7.50857C11.8146 7.50299 11.9071 7.50016 12.0003 7.50016C14.4855 7.50016 16.5003 9.51488 16.5003 12.0002C16.5003 12.0933 16.4974 12.1858 16.4919 12.2775L11.7229 7.50857Z"></path>',arrowDown:'<path d="M13.0001 16.1716L18.3641 10.8076L19.7783 12.2218L12.0001 20L4.22192 12.2218L5.63614 10.8076L11.0001 16.1716V4H13.0001V16.1716Z"></path>',arrowUp:'<path d="M13.0001 7.82843V20H11.0001V7.82843L5.63614 13.1924L4.22192 11.7782L12.0001 4L19.7783 11.7782L18.3641 13.1924L13.0001 7.82843Z"></path>',shortArrowDown:'<path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path>',shortArrowUp:'<path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path>',starFill:'<path d="M12.0006 18.26L4.94715 22.2082L6.52248 14.2799L0.587891 8.7918L8.61493 7.84006L12.0006 0.5L15.3862 7.84006L23.4132 8.7918L17.4787 14.2799L19.054 22.2082L12.0006 18.26Z"></path>',starLine:'<path d="M12.0006 18.26L4.94715 22.2082L6.52248 14.2799L0.587891 8.7918L8.61493 7.84006L12.0006 0.5L15.3862 7.84006L23.4132 8.7918L17.4787 14.2799L19.054 22.2082L12.0006 18.26ZM12.0006 15.968L16.2473 18.3451L15.2988 13.5717L18.8719 10.2674L14.039 9.69434L12.0006 5.27502L9.96214 9.69434L5.12921 10.2674L8.70231 13.5717L7.75383 18.3451L12.0006 15.968Z"></path>',starHalf:'<path d="M12.0006 15.968L16.2473 18.3451L15.2988 13.5717L18.8719 10.2674L14.039 9.69434L12.0006 5.27502V15.968ZM12.0006 18.26L4.94715 22.2082L6.52248 14.2799L0.587891 8.7918L8.61493 7.84006L12.0006 0.5L15.3862 7.84006L23.4132 8.7918L17.4787 14.2799L19.054 22.2082L12.0006 18.26Z"></path>',externalLink:'<path d="M10 6V8H5V19H16V14H18V20C18 20.5523 17.5523 21 17 21H4C3.44772 21 3 20.5523 3 20V7C3 6.44772 3.44772 6 4 6H10ZM21 3V11H19L18.9999 6.413L11.2071 14.2071L9.79289 12.7929L17.5849 5H13V3H21Z"></path>',plus:'<path d="M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"></path>',subtract:'<path d="M5 11V13H19V11H5Z"></path>',sun:'<path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z"></path>',moon:'<path d="M11.3807 2.01886C9.91573 3.38768 9 5.3369 9 7.49999C9 11.6421 12.3579 15 16.5 15C18.6631 15 20.6123 14.0843 21.9811 12.6193C21.6613 17.8537 17.3149 22 12 22C6.47715 22 2 17.5228 2 12C2 6.68514 6.14629 2.33869 11.3807 2.01886Z"></path>',wave:'<path d="M22.768125 12.478124999999999c-2.15625 4.59375 -4.03125 6.6468750000000005 -6.076874999999999 6.6468750000000005 -2.59125 0 -4.106249999999999 -3.22875 -5.709375 -6.6468750000000005 -0.6693749999999999 -1.43625 -1.3696875 -2.9156250000000004 -2.083125 -3.9721874999999995C8.2865625 7.6021875 7.7371875 7.125 7.3125 7.125c-0.35812499999999997 0 -1.71 0.38625 -4.0396875 5.353125a1.125 1.125 0 0 1 -2.0371875 -0.9562499999999999c2.15625 -4.59375 4.03125 -6.6468750000000005 6.076874999999999 -6.6468750000000005 2.59125 0 4.106249999999999 3.22875 5.709375 6.6468750000000005 0.6740625 1.43625 1.3696875 2.9203124999999996 2.083125 3.9721874999999995 0.6121875 0.90375 1.1615625 1.3809375 1.59375 1.3809375 0.35812499999999997 0 1.71 -0.38625 4.0396875 -5.353125a1.125 1.125 0 0 1 2.0371875 0.9562499999999999Z"></path>',flatline:'<path d="M2 12C2 11.4477 2.44772 11 3 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H3C2.44772 13 2 12.5523 2 12Z" fill="#0F0F0F"></path>',share:'<path d="M13.1202 17.0228L8.92129 14.7324C8.19135 15.5125 7.15261 16 6 16C3.79086 16 2 14.2091 2 12C2 9.79086 3.79086 8 6 8C7.15255 8 8.19125 8.48746 8.92118 9.26746L13.1202 6.97713C13.0417 6.66441 13 6.33707 13 6C13 3.79086 14.7909 2 17 2C19.2091 2 21 3.79086 21 6C21 8.20914 19.2091 10 17 10C15.8474 10 14.8087 9.51251 14.0787 8.73246L9.87977 11.0228C9.9583 11.3355 10 11.6629 10 12C10 12.3371 9.95831 12.6644 9.87981 12.9771L14.0788 15.2675C14.8087 14.4875 15.8474 14 17 14C19.2091 14 21 15.7909 21 18C21 20.2091 19.2091 22 17 22C14.7909 22 13 20.2091 13 18C13 17.6629 13.0417 17.3355 13.1202 17.0228ZM6 14C7.10457 14 8 13.1046 8 12C8 10.8954 7.10457 10 6 10C4.89543 10 4 10.8954 4 12C4 13.1046 4.89543 14 6 14ZM17 8C18.1046 8 19 7.10457 19 6C19 4.89543 18.1046 4 17 4C15.8954 4 15 4.89543 15 6C15 7.10457 15.8954 8 17 8ZM17 20C18.1046 20 19 19.1046 19 18C19 16.8954 18.1046 16 17 16C15.8954 16 15 16.8954 15 18C15 19.1046 15.8954 20 17 20Z"></path>',sortDesc:'<path d="M20 4V16H23L19 21L15 16H18V4H20ZM12 18V20H3V18H12ZM14 11V13H3V11H14ZM14 4V6H3V4H14Z"></path>',import:'<path d="M13 10H18L12 16L6 10H11V3H13V10ZM4 19H20V12H22V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V12H4V19Z"></path>',export:'<path d="M4 19H20V12H22V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V12H4V19ZM13 9V16H11V9H6L12 3L18 9H13Z"></path>',menu:'<path d="M3 4H21V6H3V4ZM9 11H21V13H9V11ZM3 18H21V20H3V18Z"></path>',screenshot:'<path d="M3 3H5V5H3V3ZM7 3H9V5H7V3ZM11 3H13V5H11V3ZM15 3H17V5H15V3ZM19 3H21V5H19V3ZM19 7H21V9H19V7ZM3 19H5V21H3V19ZM3 15H5V17H3V15ZM3 11H5V13H3V11ZM3 7H5V9H3V7ZM10.6667 11L11.7031 9.4453C11.8886 9.1671 12.2008 9 12.5352 9H15.4648C15.7992 9 16.1114 9.1671 16.2969 9.4453L17.3333 11H20C20.5523 11 21 11.4477 21 12V20C21 20.5523 20.5523 21 20 21H8C7.44772 21 7 20.5523 7 20V12C7 11.4477 7.44772 11 8 11H10.6667ZM14 18C15.1046 18 16 17.1046 16 16C16 14.8954 15.1046 14 14 14C12.8954 14 12 14.8954 12 16C12 17.1046 12.8954 18 14 18Z"></path>',globe:'<path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM9.71002 19.6674C8.74743 17.6259 8.15732 15.3742 8.02731 13H4.06189C4.458 16.1765 6.71639 18.7747 9.71002 19.6674ZM10.0307 13C10.1811 15.4388 10.8778 17.7297 12 19.752C13.1222 17.7297 13.8189 15.4388 13.9693 13H10.0307ZM19.9381 13H15.9727C15.8427 15.3742 15.2526 17.6259 14.29 19.6674C17.2836 18.7747 19.542 16.1765 19.9381 13ZM4.06189 11H8.02731C8.15732 8.62577 8.74743 6.37407 9.71002 4.33256C6.71639 5.22533 4.458 7.8235 4.06189 11ZM10.0307 11H13.9693C13.8189 8.56122 13.1222 6.27025 12 4.24799C10.8778 6.27025 10.1811 8.56122 10.0307 11ZM14.29 4.33256C15.2526 6.37407 15.8427 8.62577 15.9727 11H19.9381C19.542 7.8235 17.2836 5.22533 14.29 4.33256Z"></path>',close:'<path d="M11.9997 10.5865L16.9495 5.63672L18.3637 7.05093L13.4139 12.0007L18.3637 16.9504L16.9495 18.3646L11.9997 13.4149L7.04996 18.3646L5.63574 16.9504L10.5855 12.0007L5.63574 7.05093L7.04996 5.63672L11.9997 10.5865Z"></path>',github:'<path d="M12.001 2C6.47598 2 2.00098 6.475 2.00098 12C2.00098 16.425 4.86348 20.1625 8.83848 21.4875C9.33848 21.575 9.52598 21.275 9.52598 21.0125C9.52598 20.775 9.51348 19.9875 9.51348 19.15C7.00098 19.6125 6.35098 18.5375 6.15098 17.975C6.03848 17.6875 5.55098 16.8 5.12598 16.5625C4.77598 16.375 4.27598 15.9125 5.11348 15.9C5.90098 15.8875 6.46348 16.625 6.65098 16.925C7.55098 18.4375 8.98848 18.0125 9.56348 17.75C9.65098 17.1 9.91348 16.6625 10.201 16.4125C7.97598 16.1625 5.65098 15.3 5.65098 11.475C5.65098 10.3875 6.03848 9.4875 6.67598 8.7875C6.57598 8.5375 6.22598 7.5125 6.77598 6.1375C6.77598 6.1375 7.61348 5.875 9.52598 7.1625C10.326 6.9375 11.176 6.825 12.026 6.825C12.876 6.825 13.726 6.9375 14.526 7.1625C16.4385 5.8625 17.276 6.1375 17.276 6.1375C17.826 7.5125 17.476 8.5375 17.376 8.7875C18.0135 9.4875 18.401 10.375 18.401 11.475C18.401 15.3125 16.0635 16.1625 13.8385 16.4125C14.201 16.725 14.5135 17.325 14.5135 18.2625C14.5135 19.6 14.501 20.675 14.501 21.0125C14.501 21.275 14.6885 21.5875 15.1885 21.4875C19.259 20.1133 21.9999 16.2963 22.001 12C22.001 6.475 17.526 2 12.001 2Z"></path>',book:'<path d="M4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21H14C14.5523 21 15 20.5523 15 20V10.6973L17.0215 20.2076C17.1363 20.7479 17.6673 21.0927 18.2075 20.9779L21.142 20.3541C21.6822 20.2393 22.027 19.7083 21.9122 19.1681L19.0015 5.47402C18.8866 4.9338 18.3556 4.58896 17.8154 4.70378L15 5.30221V5C15 4.44772 14.5523 4 14 4H9C9 3.44772 8.55228 3 8 3H4ZM9 6H13V14H9V6ZM13 16V19H9V16H13ZM7 17V19H5V17H7ZM18.7699 18.8137L18.3541 16.8577L19.3323 16.6498L19.748 18.6058L18.7699 18.8137Z"></path>',donation:'<path d="M9.3349 11.5022L11.5049 11.5027C13.9902 11.5027 16.0049 13.5174 16.0049 16.0027L9.00388 16.0018L9.00488 17.0027L17.0049 17.0019V16.0027C17.0049 14.9202 16.6867 13.8996 16.1188 13.0019L19.0049 13.0027C20.9972 13.0027 22.7173 14.1679 23.521 15.8541C21.1562 18.9747 17.3268 21.0027 13.0049 21.0027C10.2436 21.0027 7.90437 20.4121 6.00447 19.3779L6.00592 10.0737C7.25147 10.2521 8.39122 10.7583 9.3349 11.5022ZM4.00488 9.00268C4.51772 9.00268 4.94039 9.38872 4.99816 9.88606L5.00488 10.0018V19.0027C5.00488 19.555 4.55717 20.0027 4.00488 20.0027H2.00488C1.4526 20.0027 1.00488 19.555 1.00488 19.0027V10.0027C1.00488 9.45039 1.4526 9.00268 2.00488 9.00268H4.00488ZM13.6513 3.57806L14.0046 3.93183L14.3584 3.57806C15.3347 2.60175 16.9177 2.60175 17.894 3.57806C18.8703 4.55437 18.8703 6.13728 17.894 7.11359L14.0049 11.0027L10.1158 7.11359C9.13948 6.13728 9.13948 4.55437 10.1158 3.57806C11.0921 2.60175 12.675 2.60175 13.6513 3.57806Z"></path>'},Icon(e,t=""){return`\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"\n      style="${""!==t?t:"width: 1rem; height: 1rem;"}"\n    >\n      ${this.iconPath[e]}\n    </svg>\n    `}};class MiscPanel extends HTMLElement{constructor(){super();const n=t.get("LANGUAGE.ENABLE_I18N");this.innerHTML=`\n    <div class="menu-panel" id="misc-panel" data-target="misc-panel">\n      <div class="misc-row">\n        <gt-button class="dark-mode-toggle" title="Toggle dark mode">\n          ${"dark"===document.documentElement.getAttribute("data-theme")?L.Icon("moon","width: 1.25rem; height: 1.25rem"):L.Icon("sun","width: 1.25rem; height: 1.25rem")}\n        </gt-button>\n        ${n?`<gt-divider></gt-divider>\n            ${L.Icon("globe","width: 1.5rem; height: 1.5rem")}\n            <language-selector></language-selector>`:""}\n      </div>\n      <div class="misc-description" id="db-description">\n      </div>\n      <gt-divider horizontal style="margin: 1rem 0 0.8rem 0;"></gt-divider>\n      <div class="misc-info">\n        <div class="misc-info-title">\n          <h2>modernGraphTool</h2>\n          <h4>beta</h4>\n        </div>\n        <p style="margin-bottom: 0.2rem;">\n          Open-source project under the MIT license\n        </p>\n        <div class="misc-info-button-row">\n          <button name="github-button" title="Go to Github Repository"\n            onclick="window.open('https://github.com/potatosalad775/modernGraphTool', '_blank')"\n          >\n            ${L.Icon("github","width: 1.5rem; height: 1.5rem")}\n          </button>\n          <button name="github-button" title="Go to Documentation page"\n            onclick="window.open('https://potatosalad775.github.io/modernGraphTool/docs', '_blank')"\n          >\n            ${L.Icon("book","width: 1.5rem; height: 1.5rem")}\n          </button>\n          <button name="github-button" title="Go to Donation page"\n            onclick="window.open('https://ko-fi.com/potatosalad775', '_blank')"\n          >\n            ${L.Icon("donation","width: 1.5rem; height: 1.5rem")}\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <style>\n      .misc-row {\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        gap: 0.5rem;\n      }\n      .misc-info {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        gap: 0.3rem;\n        margin: 0;\n        h4, p {\n            margin: 0;\n        }\n      }\n      .misc-info-title {\n        display: flex;\n        align-items: baseline;\n        gap: 0.5rem;\n        h2, h4 {\n          margin: 0;\n        }\n      }\n      .misc-info-button-row {\n        display: flex;\n        gap: 0.25rem;\n        button {\n          padding: 0.25rem;\n          border-radius: 0.5rem;\n        }\n      }\n      .misc-description {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        gap: 0.5rem;\n        margin: 0.5rem 0 0 0;\n        h1, h2, h3, h4, h5, h6, p {\n          margin: 0;\n        }\n      }\n    </style>\n    `,this.appendDescription(),this.attachDarkModeToggleListener(),e.addObserver(this.updateLanguage.bind(this))}attachDarkModeToggleListener(){const e=this.querySelector(".dark-mode-toggle");e&&e.addEventListener("click",(e=>{const t="dark"===document.documentElement.getAttribute("data-theme");e.target.innerHTML=t?L.Icon("sun","width: 1.25rem; height: 1.25rem"):L.Icon("moon","width: 1.25rem; height: 1.25rem"),document.documentElement.setAttribute("data-theme",t?"light":"dark")}))}appendDescription(){const e=t.get("DESCRIPTION");if(e&&0!==e.length){if(e.length>0){const e=document.createElement("span");e.style.width="100%",e.innerHTML='<gt-divider horizontal style="margin: 0.5rem 0;"></gt-divider>',this.querySelector(".misc-description").appendChild(e)}e.forEach(((e,t)=>{if("text"===e.TYPE.toLowerCase()){const n=document.createElement("p");n.textContent=e.CONTENT,n.setAttribute("desc-index",t),this.querySelector(".misc-description").appendChild(n)}else if("image"===e.TYPE.toLowerCase()){const n=document.createElement("img");n.src=e.CONTENT,n.setAttribute("desc-index",t),this.querySelector(".misc-description").appendChild(n)}else if("html"===e.TYPE.toLowerCase()){const n=document.createElement("div");n.innerHTML=e.CONTENT,n.setAttribute("desc-index",t),this.querySelector(".misc-description").appendChild(n)}else console.error(`Unknown misc panel description type: ${e.TYPE}`)}))}}updateLanguage(){const e=t.get("DESCRIPTION"),n=this.querySelector(".misc-description");e.forEach(((e,t)=>{const r=n.querySelector(`[desc-index="${t}"]`);r&&("text"===e.TYPE.toLowerCase()?r.textContent=e.CONTENT:"image"===e.TYPE.toLowerCase()?r.src=e.CONTENT:"html"===e.TYPE.toLowerCase()&&(r.innerHTML=e.CONTENT))}))}}customElements.define("misc-panel",MiscPanel);var x=Object.freeze({__proto__:null});class GraphContainer extends HTMLElement{constructor(){super(),this.id="graph-container",this.innerHTML='\n      <svg id="fr-graph"></svg>\n    ';const e=document.createElement("style");e.textContent='\n#graph-container {\n  position: relative;\n  height: fit-content;\n}\n\n#fr-graph {\n  min-height: fit-content;\n  max-width: 100%;\n  aspect-ratio: 16/9;\n}\n\n.fr-graph-label {\n  display: flex;\n  flex-direction: column;\n}\n\n:root {\n  --watermark-text-filter: none;\n}\n:root[data-theme="dark"] {\n  --watermark-text-filter: invert(1.0);\n}\n',this.appendChild(e),n.dispatchInitEvent("graph-ui-ready")}}customElements.define("graph-container",GraphContainer);var E=Object.freeze({__proto__:null});class TopNavBar extends HTMLElement{constructor(){super(),this.isMobile=document.documentElement.hasAttribute("data-mobile")||window.innerWidth<1e3,this.linkList=t.get("TOPBAR.LINK_LIST")||[],this.render(),this.setupEventListeners()}connectedCallback(){window.addEventListener("core:ui-mode-change",this._handleScreenResize.bind(this)),e.addObserver(this._handleLanguageChange.bind(this))}disconnectedCallback(){window.removeEventListener("core:ui-mode-change",this._handleScreenResize.bind(this)),e.removeObserver(this._handleLanguageChange.bind(this))}render(){const n=t.get("TOPBAR.TITLE.TYPE")||"TEXT",r=t.get("TOPBAR.TITLE.CONTENT")||"modernGraphTool";this.innerHTML=`\n      <header class="header">\n        <nav class="top-nav-bar">\n          <div class="top-nav-bar-leading">\n            <a class="top-nav-bar-leading-title" href=".">\n              ${"HTML"===n?r:""}\n              ${"TEXT"===n?"<h2>"+r+"</h2>":""}\n              ${"IMAGE"===n?"<img src='"+r+"' alt='topbar title'/>":""}\n            </a>\n          </div>\n          \x3c!-- Trailing Button --\x3e\n          <button class="mobile-menu-button" style="display: ${this.isMobile?"block":"none"}">\n            ${L.Icon("menu","width: 1.5rem; height: 1.5rem;")}\n          </button>\n          <div class="mobile-sidebar" style="display: ${this.isMobile?"block":"none"}">\n            <div class="mobile-sidebar-overlay"></div>\n            <div class="mobile-sidebar-content">\n              <div class="mobile-sidebar-header">\n                <h2>${e.getString("top-nav-bar.sidebar-link-title","LINKS")}</h2>\n                <button class="mobile-sidebar-close">\n                  ${L.Icon("close","width: 1.5rem; height: 1.5rem;")}\n                </button>\n              </div>\n              ${this.linkList.map((e=>`\n                <a href="${e.URL}" target="_blank" rel="noopener">${e.TITLE}</a>\n              `)).join("")}\n            </div>\n          </div>\n          <div class="top-nav-bar-trailing" style="display: ${this.isMobile?"none":"flex"}">\n            ${this.linkList.map((e=>`\n              <a href="${e.URL}" target="_blank" rel="noopener">${e.TITLE}</a>\n            `)).join("")}\n          </div>\n        </nav>\n      </header>\n    `;const i=document.createElement("style");i.textContent="\n  .top-nav-bar {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    height: 2rem;\n    padding: 0.5rem 1rem;\n    background: var(--gt-color-surface-container);\n    border-bottom: 1px solid var(--gt-color-outline-variant);\n  }\n\n  .top-nav-bar-leading {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .top-nav-bar-leading-title {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n    text-decoration: none;\n    color: var(--gt-color-on-surface);\n  }\n\n  .top-nav-bar-leading h2 {\n    margin: 0;\n    font: var(--gt-typescale-title-medium);\n  }\n\n  .top-nav-bar-leading img {\n    height: 2rem;\n  }\n\n  .top-nav-bar-trailing {\n    display: flex;\n    gap: 0.25rem;\n    align-items: center;\n  }\n\n  .top-nav-bar-trailing a {\n    text-decoration: none;\n    color: var(--gt-color-on-surface-variant);\n    font-size: 0.9rem;\n    padding: 0.25rem 0.75rem;\n    border-radius: 0.5rem;\n  }\n\n  /* Mobile styles */\n  .mobile-menu-button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 2rem;\n    width: 2rem;\n    padding: 0;\n    border: none;\n    background: none;\n    cursor: pointer;\n    border-radius: 0.5rem;\n  }\n\n  .mobile-menu-button svg {\n    color: var(--gt-color-on-surface-variant);\n  }\n\n  .mobile-sidebar {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 1000;\n    display: flex;\n    pointer-events: none;\n  }\n\n  .mobile-sidebar.visible {\n    pointer-events: auto;\n  }\n\n  .mobile-sidebar-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0, 0, 0, 0.4);\n    opacity: 0;\n    transition: opacity 0.3s ease;\n  }\n\n  .mobile-sidebar.visible .mobile-sidebar-overlay {\n    opacity: 1;\n  }\n\n  .mobile-sidebar-content {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    width: 70vw;\n    max-width: 20rem;\n    height: 100%;\n    background: var(--gt-color-surface);\n    transform: translateX(100%);\n    transition: transform 0.3s ease;\n    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);\n    box-sizing: border-box;\n    border-radius: 1rem 0 0 1rem;\n  }\n\n  .mobile-sidebar.visible .mobile-sidebar-content {\n    transform: translateX(0);\n  }\n\n  .mobile-sidebar-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin: 1.5rem;\n    margin-bottom: 0.75rem;\n\n    h2 {\n      margin: 0;\n    }\n  }\n\n  .mobile-sidebar-content a {\n    text-decoration: none;\n    color: var(--gt-color-on-surface-variant);\n    font: var(--gt-typescale-body-large);\n    padding: 0.5rem;\n    margin: 0.25rem 1rem;\n    border-radius: 0.5rem;\n  }\n\n  .mobile-sidebar-close {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 2rem;\n    height: 2rem;\n    border-radius: 0.5rem;\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .top-nav-bar-trailing a:hover {\n      color: var(--gt-color-primary);\n      background: var(--gt-color-surface-container);\n      filter: var(--gt-hover-filter);\n    }\n\n    .mobile-menu-button svg:hover {\n      color: var(--gt-color-on-surface);\n    }\n      \n    .mobile-sidebar-content a:hover {\n      background: var(--gt-color-surface-variant);\n      color: var(--gt-color-on-surface);\n    }\n  }\n",this.appendChild(i)}setupEventListeners(){const e=this.querySelector(".mobile-menu-button"),t=this.querySelector(".mobile-sidebar"),n=this.querySelector(".mobile-sidebar-overlay"),r=this.querySelector(".mobile-sidebar-close");e?.addEventListener("click",(()=>{t.classList.add("visible"),document.body.style.overflow="hidden"})),n?.addEventListener("click",(()=>{t.classList.remove("visible"),document.body.style.overflow=""})),r?.addEventListener("click",(()=>{t.classList.remove("visible"),document.body.style.overflow=""}))}_handleScreenResize(e=null){e&&this.isMobile!==e?.detail.isMobile&&(this.isMobile=e.detail.isMobile),this.isMobile?(this.querySelector(".top-nav-bar-trailing").style.display="none",this.querySelector(".mobile-menu-button").style.display="block",this.querySelector(".mobile-sidebar").style.display="block"):(this.querySelector(".top-nav-bar-trailing").style.display="flex",this.querySelector(".mobile-menu-button").style.display="none",this.querySelector(".mobile-sidebar").style.display="none")}_handleLanguageChange(){this.linkList=t.get("TOPBAR.LINK_LIST")||[];const n=this.querySelector(".top-nav-bar-trailing");n&&(n.innerHTML=this.linkList.map((e=>`\n        <a href="${e.URL}" target="_blank" rel="noopener">${e.TITLE}</a>\n      `)).join(""));const r=this.querySelector(".mobile-sidebar-content");if(r){const t=r.querySelector(".mobile-sidebar-header h2");t&&(t.textContent=e.getString("top-nav-bar.sidebar-link-title","LINKS")),r.querySelectorAll("a").forEach((e=>e.remove())),this.linkList.forEach((e=>{const t=document.createElement("a");t.href=e.URL,t.target="_blank",t.rel="noopener",t.textContent=e.TITLE,r.appendChild(t)}))}}}customElements.define("top-nav-bar",TopNavBar);var _=Object.freeze({__proto__:null});class MenuContainer extends HTMLElement{constructor(){super();const e=h.getCoreMenuPanels();this.className="menu-container",this.innerHTML=`\n      <div class="menu-slider">\n        <div class="menu-panels">\n          ${e}\n        </div>\n      </div>\n      <style>\n        \n.menu-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  overflow: hidden;\n  background: var(--gt-color-surface);\n}\n\n.menu-slider {\n  flex: 1;\n  position: relative;\n  overflow-x: hidden;\n}\n\n.menu-panels {\n    position: relative;\n    height: 100%;\n    width: 100%;\n    box-sizing: border-box;\n}\n\n.menu-panel {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    overflow-x: hidden;\n    overflow-y: auto;\n    padding: 0.9rem 0.5rem 0 0.5rem;\n    opacity: 0;\n    transform: translateX(30%);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    pointer-events: none;\n    box-sizing: border-box;\n    scrollbar-gutter: stable both-edges;\n}\n\n.menu-panel.active {\n    opacity: 1;\n    transform: translateX(0);\n    pointer-events: all;\n    transition-delay: 0.1s;\n}\n\n.menu-panel:not(.active) {\n    transform: translateX(-30%);\n    transition-delay: 0s;\n}\n\n      </style>\n    `,this._addEventListener()}_addEventListener(){window.addEventListener("core:menu-switched",(e=>{this.querySelectorAll(".menu-panel").forEach((t=>{t.id===e.detail.target?t.classList.add("active"):t.classList.remove("active")}))}))}}customElements.define("menu-container",MenuContainer);var S=Object.freeze({__proto__:null});class MenuCarousel extends HTMLElement{constructor(){super(),this.currentIndex=h.coreMenuList.indexOf(h.currentMenu),this.isDragging=!1,this.startX=0,this.currentX=0,this.lastDragX=0,this.animationFrame=null,this.isSnapping=!1,this.snapDebounceTime=100;const e=h.getCoreMenuBarItem();this.innerHTML=`\n      <nav class="menu-carousel-group">\n        <div class="menu-carousel">\n          ${e}\n        </div>\n      </nav>\n    `;const t=document.createElement("style");t.textContent="\n  .menu-carousel-group {\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: var(--gt-color-surface-container);\n    height: 4.5rem;\n    overflow: hidden;\n    touch-action: pan-x;\n  }\n\n  .menu-carousel {\n    position: absolute;\n    display: flex;\n    gap: 0.75rem;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    will-change: transform;\n    padding: 0 calc(50% - 3rem); /* Half of container minus half of item width */\n  }\n\n  .menu-bar-item {\n    min-width: 6rem;\n    height: 2.5rem;\n    margin: 1rem 0;\n    background: none;\n    border: none;\n    border-radius: 1.5rem;\n    cursor: pointer;\n    color: var(--gt-color-on-surface);\n    font: var(--gt-typescale-title-small);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    transform-origin: center;\n    opacity: 0.5;\n    scale: 0.8;\n    flex-shrink: 0;\n    -webkit-tap-highlight-color: transparent;\n  }\n\n  .menu-bar-item.active {\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    opacity: 1;\n    scale: 1;\n  }\n\n  .menu-bar-item.nearby {\n    opacity: 0.8;\n    scale: 0.9;\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .menu-bar-item:hover {\n      filter: var(--gt-hover-filter);\n    }\n  }\n",this.appendChild(t),this._updateCarousel()}connectedCallback(){this._handleExtensionAdded=()=>{this._updateCarousel(),this._removeButtonListeners(),this._setupButtonListeners()},this._handleWheel=e=>{e.preventDefault();const t=0!==e.deltaX?e.deltaX:e.deltaY;if(this.wheelAccumulator+=t*this.wheelSensitivity,Math.abs(this.wheelAccumulator)>=this.wheelThreshold){const e=Math.sign(this.wheelAccumulator);this._snap(this.currentIndex+e),this.wheelAccumulator=0}},this._handleDragStart=this._startDragging.bind(this),this._handleDrag=this._drag.bind(this),this._handleDragEnd=this._stopDragging.bind(this),window.addEventListener("core:ui-mode-change",this._handleUIModeChange.bind(this)),window.addEventListener("core:extension-menu-added",this._handleExtensionAdded),this.wheelAccumulator=0,this.wheelSensitivity=.3,this.wheelThreshold=1,this.addEventListener("wheel",this._handleWheel,{passive:!1}),this.addEventListener("mousedown",this._handleDragStart),window.addEventListener("mousemove",this._handleDrag),window.addEventListener("mouseup",this._handleDragEnd),window.addEventListener("mouseleave",this._handleDragEnd),this.addEventListener("touchstart",this._handleDragStart,{passive:!1}),window.addEventListener("touchmove",this._handleDrag,{passive:!1}),window.addEventListener("touchend",this._handleDragEnd),window.addEventListener("touchcancel",this._handleDragEnd),this._setupButtonListeners()}disconnectedCallback(){window.removeEventListener("core:ui-mode-change",this._handleUIModeChange.bind(this)),window.removeEventListener("core:extension-menu-added",this._handleExtensionAdded),this.removeEventListener("wheel",this._handleWheel),this.removeEventListener("mousedown",this._handleDragStart),window.removeEventListener("mousemove",this._handleDrag),window.removeEventListener("mouseup",this._handleDragEnd),window.removeEventListener("mouseleave",this._handleDragEnd),this.removeEventListener("touchstart",this._handleDragStart),window.removeEventListener("touchmove",this._handleDrag),window.removeEventListener("touchend",this._handleDragEnd),window.removeEventListener("touchcancel",this._handleDragEnd),this._removeButtonListeners()}_setupButtonListeners(){this._buttonHandlers=new Map,this._touchStartX=0,this._touchStartTime=0,this._buttons.forEach(((e,t)=>{const handleTouchStart=e=>{e.preventDefault(),this._touchStartX=e.touches[0].clientX,this._touchStartTime=Date.now()},handleTouchEnd=e=>{const n=e.changedTouches?e.changedTouches[0].clientX:e.clientX,r=Math.abs(n-this._touchStartX)>10||Date.now()-this._touchStartTime>200;if(r)return;e.preventDefault();const i=e.currentTarget.dataset.target;if(!r&&i){const e=t-this.currentIndex;this._animateToIndex(t,e)}},handleClick=e=>{e.preventDefault();if(e.currentTarget.dataset.target){const e=t-this.currentIndex;this._animateToIndex(t,e)}};this._buttonHandlers.set(e,{handleClick:handleClick,handleTouchStart:handleTouchStart,handleTouchEnd:handleTouchEnd}),e.addEventListener("touchstart",handleTouchStart,{passive:!1}),e.addEventListener("touchend",handleTouchEnd,{passive:!1}),e.addEventListener("click",handleClick)}))}_animateToIndex(e,t){if(this.isSnapping||e===this.currentIndex)return;this.isSnapping=!0;const r=Math.abs(t);let i=0;const animate=()=>{i++;const a=this.currentIndex+Math.sign(t);if(this.currentIndex=a,this._updateCarousel(!0),i<r)requestAnimationFrame(animate);else{setTimeout((()=>{this.isSnapping=!1}),this.snapDebounceTime);const t=this._buttons[e].dataset.target;n.dispatchEvent("menu-switched",{target:t})}};requestAnimationFrame(animate)}_removeButtonListeners(){this._buttonHandlers&&(this._buttonHandlers.forEach(((e,t)=>{t.removeEventListener("click",e.handleClick),t.removeEventListener("touchstart",e.handleTouchStart),t.removeEventListener("touchend",e.handleTouchEnd)})),this._buttonHandlers.clear())}_updateCarousel(e=!0){this._carousel=this.querySelector(".menu-carousel"),this._buttons=Array.from(this.querySelectorAll(".menu-bar-item")).filter((e=>"none"!==window.getComputedStyle(e).display));const t=108*(this._buttons.length/2-.5-this.currentIndex);this._carousel.style.transition=e?"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)":"none",this._carousel.style.transform=`translateX(${t}px)`,this._buttons.forEach(((e,t)=>{e.classList.toggle("nearby",1===Math.abs(t-this.currentIndex)),e.classList.toggle("active",t===this.currentIndex)}))}_startDragging(e){e.type.startsWith("touch")&&e.preventDefault(),this.isDragging=!0,this.startX=e.type.startsWith("touch")?e.touches[0].pageX:e.pageX,this.currentX=this.startX,this.lastDragX=this.startX,this._carousel.style.transition="none",this.dragStartIndex=this.currentIndex,this.animationFrame&&cancelAnimationFrame(this.animationFrame)}_drag(e){this.isDragging&&(e.type.startsWith("touch")&&e.preventDefault(),this.currentX=e.type.startsWith("touch")?e.touches[0].pageX:e.pageX,this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame((()=>{const e=this._buttons.length,t=this.currentX-this.startX,n=108*(e/2-.5-this.dragStartIndex);this._carousel.style.transform=`translateX(${n+t}px)`;const r=Math.round(-t/108)+this.dragStartIndex;r!==this.currentIndex&&r>=0&&r<this._buttons.length&&(this.currentIndex=r,this._updateActiveStates()),this.lastDragX=this.currentX})))}_stopDragging(){if(!this.isDragging)return;this.isDragging=!1,this.animationFrame&&cancelAnimationFrame(this.animationFrame);const e=this.currentX-this.lastDragX,t=Math.sign(e);Math.abs(e)>5?this._snap(this.currentIndex-t):this._snap(this.currentIndex)}_snap(e){if(this.isSnapping)return;const t=Math.max(0,Math.min(e,this._buttons.length-1));t!==this.currentIndex?(this.isSnapping=!0,this.currentIndex=t,this._updateCarousel(!0),setTimeout((()=>{this.isSnapping=!1}),this.snapDebounceTime)):this._updateCarousel(!0);const r=this._buttons[t].dataset.target;n.dispatchEvent("menu-switched",{target:r})}_updateActiveStates(){this._buttons.forEach(((e,t)=>{const n=Math.abs(t-this.currentIndex);e.classList.toggle("nearby",1===n),e.classList.toggle("active",t===this.currentIndex)}))}_handleUIModeChange(e){e.detail.isMobile||"list"!==h.coreMenuList[this.currentIndex]||this._animateToIndex(h.coreMenuList.indexOf("graph"),-1),this._updateCarousel(),this._removeButtonListeners(),this._setupButtonListeners()}}customElements.define("menu-carousel",MenuCarousel);var C=Object.freeze({__proto__:null});class PhoneSelector extends HTMLElement{constructor(){super(),this.className="phone-selector-container",this.innerHTML=`\n      <header class="ps-header">\n        <gt-button class="ps-header-nav-brand" variant="filled">\n          ${"< "+e.getString("phone-selector.header-brand-btn","Brands")}\n        </gt-button>\n        <input type="search" class="ps-header-search" placeholder='${e.getString("phone-selector.header-search-bar-placeholder","Search")}'>\n        <gt-button class="ps-header-nav-phone" variant="filled" style="display:none">\n          ${e.getString("phone-selector.header-device-btn","Devices")+" >"}\n        </gt-button>\n      </header>\n      <div class="ps-lists">\n        <div class="ps-brand-list"></div>\n        <div class="ps-phone-list mobile-visible"></div>\n      </div>\n    `;const t=document.createElement("style");t.textContent='\n.phone-selector-container {\n  display: flex;\n  flex-direction: column;\n  min-width: 20rem;\n  height: inherit;\n  background: var(--gt-color-surface);\n  box-sizing: border-box;\n  container: ps-container / inline-size;\n}\n\n.ps-header {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 2.75rem;\n  gap: 1rem;\n  padding: 0 1rem 1rem 1rem;\n}\n\n.ps-header-search {\n  flex: 1;\n  width: 100%;\n  height: 2.7rem;\n  padding: 0 1.25rem;\n  border: none;\n  border-radius: 4rem;\n  background: var(--gt-color-surface-container-highest);\n  color: var(--gt-color-on-surface);\n}\n.ps-header-search::placeholder {\n  color: var(--gt-color-on-surface-variant);\n}\n.ps-header-search:focus, .ps-header-search:focus-visible {\n  outline: 2px solid var(--gt-color-secondary);\n}\n\n.ps-lists {\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  overflow: hidden;\n  position: relative;\n}\n\n.ps-brand-list {\n  flex: 1;\n  display: block;\n  overflow-y: auto;\n  margin-right: 0.5rem;\n  padding: 0 0.5rem;\n  box-sizing: border-box;\n  min-width: 7rem;\n  scrollbar-gutter: stable both-edges;\n}\n\n.ps-brand-item {\n  display: flex;\n  align-items: center;\n  padding: 0 1rem;\n  margin: 0.75rem 0;\n  height: 2.5rem;\n  border-radius: 2.5rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  gap: 0.75rem;\n  background: var(--gt-color-surface);\n  border: 1px solid var(--gt-color-outline);\n  color: var(--gt-color-primary);\n\n  input {\n    display: none;\n  }\n\n  span {\n    width: 100%;\n    height: 2.25rem;\n    align-content: center;\n    font: var(--gt-typescale-title-small);\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n  }\n}\n.ps-brand-item:first-child {\n  margin-top: 0;\n}\n.ps-brand-item:has(input:checked) {\n  background: var(--gt-color-secondary);\n  color: var(--gt-color-on-secondary);\n}\n\n.ps-phone-list {\n  flex: 2;\n  display: block;\n  transition: all 0.2s ease;\n  padding: 0 0.5rem 0 0;\n  overflow-y: scroll;\n  scrollbar-gutter: stable both-edges;\n}\n\n.ps-phone-item {\n  border-radius: 0.75rem;\n  min-height: fit-content;\n  margin: 0.75rem 0;\n  transition: all 0.2s ease-out;\n  background: var(--gt-color-surface-container);\n  color: var(--gt-color-on-surface);\n  border: 1px solid var(--gt-color-surface-container-highest);\n  overflow: hidden;\n\n  label {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n    flex-direction: column;\n    position: relative;\n    padding: 0.7rem 1rem;\n    gap: 0.3rem;\n    cursor: pointer;\n  }\n\n  input {\n    display: none;\n  }\n}\n.ps-phone-item:has(input:checked) {\n  background: var(--gt-color-primary);\n  color: var(--gt-color-on-primary);\n\n  .ps-phone-review-score {\n    background: var(--gt-color-primary-container);\n    color: var(--gt-color-on-primary-container);\n  }\n  .ps-link-group a {\n    color: var(--gt-color-primary-container);\n  }\n}\n.ps-phone-item:first-child {\n  margin-top: 0;\n}\n.ps-phone-item:has(input:disabled) {\n  cursor: not-allowed;\n}\n.ps-phone-item[aria-busy="true"]::after {\n  border-radius: inherit;\n}\n\n.ps-phone-name {\n  width: 100%;\n  font: var(--gt-typescale-title-small);\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n}\n\n.ps-phone-review-score {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.2rem;\n  position: absolute;\n  top: 0.6rem;\n  right: 0.6rem;\n  height: 1rem;\n  background: var(--gt-color-primary);\n  color: var(--gt-color-on-primary);\n  padding: 0.5rem;\n  border-radius: 0.7rem;\n  font-weight: 500;\n\n  svg {\n    width: 1rem;\n    height: 1rem;\n  }\n}\n\n.ps-link-group {\n  display: flex;\n  flex-direction: row;\n  gap: 0.5rem;\n  margin-top: 0.1rem;\n\n  a {\n    display: flex;\n    flex-direction: row;\n    gap: 0.2rem;\n    align-items: stretch;\n    color: var(--gt-color-primary);\n  }\n\n  svg {\n    width: 1rem;\n    height: 1rem;\n  }\n}\n\n.ps-brand-item:active {\n  filter: var(--gt-hover-filter);\n  transition: filter 0s;\n}\n\n.ps-phone-item:active {\n  -webkit-box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n  -moz-box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n  box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n  transition: box-shadow 0s;\n}\n\n.ps-link-group a:active {\n  color: var(--gt-color-teritary-container);\n  transition: color 0s;\n}\n\n.ps-link-group a:active {\n  color: var(--gt-color-teritary);\n  transition: color 0s;\n}\n\n.ps-clear-brands-btn {\n  position: absolute;\n  bottom: 1rem;\n  left: 50%;\n  height: 2.1rem;\n  transform: translateX(-50%);\n  padding: 0.5rem 1rem 0.5rem 0.75rem;\n  border-radius: 2rem;\n  background: var(--gt-color-tertiary);\n  color: var(--gt-color-on-tertiary);\n  box-shadow: 0 0 0.5rem rgba(0, 0, 0, 0.3);\n  border: none;\n  cursor: pointer;\n  font-weight: 500;\n  z-index: 10;\n  transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;\n  opacity: 0;\n  pointer-events: none; /* Hidden by default */\n}\n\n.ps-clear-brands-btn.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .ps-brand-item:hover {\n    filter: var(--gt-hover-filter);\n  }\n\n  .ps-phone-item:hover {\n    -webkit-box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n    -moz-box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n    box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n  }\n\n  .ps-link-group a:hover {\n    color: var(--gt-color-teritary-container);\n  }\n\n  .ps-link-group a:hover {\n    color: var(--gt-color-teritary);\n  }\n\n  .ps-clear-brands-btn:hover {\n    background: var(--gt-color-tertiary);\n    filter: var(--gt-hover-filter);\n  }\n}\n\n/* responsive layout */\n.ps-header-nav-brand, .ps-header-nav-phone {\n  display: none;\n  min-width: fit-content;\n}\n\n@container ps-container (max-width: 500px) {\n  .ps-brand-list {\n    position: absolute;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    transition: transform 0.3s ease-in-out;\n    transform: translateX(0);\n    box-sizing: border-box;\n    overflow-y: scroll;\n  }\n  .ps-brand-list.mobile-visible {\n    transform: translateX(100%);\n  }\n  \n  .ps-phone-list {\n    position: absolute;\n    right: -100%;\n    width: 100%;\n    height: 100%;\n    padding: 0 0.5rem;\n    transition: transform 0.3s ease-in-out;\n    transform: translateX(0);\n    box-sizing: border-box;\n  }\n  .ps-phone-list.mobile-visible {\n    transform: translateX(-100%);\n  }\n\n  .ps-header-nav-brand, .ps-header-nav-phone {\n    display: block;\n    height: 2.5rem;\n  }\n}\n',this.appendChild(t),this.brandListElement=this.querySelector(".ps-brand-list"),this.phoneListElement=this.querySelector(".ps-phone-list"),this.clearBrandsButton=document.createElement("button"),this.clearBrandsButton.className="ps-clear-brands-btn",this.clearBrandsButton.innerHTML=`\n      ${L.Icon("close","width: 1.25rem; height: 1.25rem; margin-right: 0.25rem")}\n      ${e.getString("phone-selector.clear-brands-btn","Unselect Brands")}\n    `,this.querySelector(".ps-lists").appendChild(this.clearBrandsButton),this.clearBrandsButton.addEventListener("click",this._clearBrandSelection.bind(this)),this.querySelector(".ps-header-search").addEventListener("input",(e=>{this._filterPhoneList(e.target.value)})),this.querySelector(".ps-header-nav-brand").addEventListener("click",(e=>this._switchListPanel(e,"brand"))),this.querySelector(".ps-header-nav-phone").addEventListener("click",(e=>this._switchListPanel(e,"phone")))}connectedCallback(){window.addEventListener("core:fr-phone-added",(e=>this._changePhoneItemBtnStatus(e,!0))),window.addEventListener("core:fr-phone-removed",(e=>this._changePhoneItemBtnStatus(e,!1))),window.addEventListener("core:metadata-loaded",(()=>this._init())),e.addObserver(this._updateLanguage.bind(this)),/Android/.test(navigator.userAgent)&&window.addEventListener("core:init-ready",(()=>{this.style.display="none",setTimeout((()=>{this.style.display="flex"}),"1000")}))}disconnectedCallback(){window.removeEventListener("core:fr-phone-added",(e=>this._changePhoneItemBtnStatus(e,!0))),window.removeEventListener("core:fr-phone-removed",(e=>this._changePhoneItemBtnStatus(e,!1))),window.removeEventListener("core:metadata-loaded",(()=>this._init())),e.removeObserver(this._updateLanguage.bind(this))}_init(){null!==d.phoneMetadata&&(this.brandListData=Array.from(d.phoneMetadata).map((e=>e.brand)),this.fullPhoneListData=Array.from(d.phoneMetadata).flatMap((e=>e.phones.map((t=>({...t,brand:e.brand}))))),this.phoneListData=Array.from(d.phoneMetadata).flatMap((e=>e.phones.map((t=>({...t,brand:e.brand}))))),this._renderBrandList(),this._renderPhoneList(),this._addBrandEventListeners(),this._addPhoneEventListeners(),this._updateClearBrandsButtonVisibility(),n.dispatchInitEvent("phone-ui-ready"))}_renderBrandList(){this.brandListElement.innerHTML="",this.brandListData.forEach((e=>{const t=document.createElement("label");t.className="ps-brand-item",t.innerHTML=`\n        <input type="checkbox" data-identifier="${e}">\n        <span>${e}</span>\n      `,this.brandListElement.appendChild(t)}))}_renderPhoneList(){this.phoneListElement.innerHTML="",this.phoneListData.forEach((t=>{const n=document.createElement("div");n.className="ps-phone-item",n.innerHTML=`\n        <label>\n          <input type="checkbox" \n            data-identifier="${t.identifier}" \n            ${c.isFRDataLoaded(t.identifier)?"checked":""}\n          >\n          <span class="ps-phone-name">${t.identifier}</span>\n          ${t.reviewScore?`<span class="ps-phone-review-score">${this._getScoreElement(t.reviewScore)}</span>`:""}\n          ${t.price?`<span class="ps-phone-price">${t.price}</span>`:""}\n          ${t.reviewLink||t.shopLink?`<div class="ps-link-group">\n                ${t.reviewLink?`<a target="_blank" rel="noopener" href="${t.reviewLink}" class="ps-link-review">\n                      ${L.Icon("externalLink")} ${e.getString("phone-selector.item-review","Review")}\n                    </a>`:""}\n                ${t.shopLink?`<a target="_blank" rel="noopener" href="${t.shopLink}" class="ps-link-shop">\n                      ${L.Icon("externalLink")} ${e.getString("phone-selector.item-shop","Shop")}\n                    </a>`:""}\n              </div>`:""}\n        </label>\n      `,this.phoneListElement.appendChild(n)}))}_addBrandEventListeners(){this.shouldSwitchPanelOnClick=t.get("INTERFACE.SWITCH_PHONE_PANEL_ON_BRAND_CLICK")||!0,this.querySelectorAll(".ps-brand-item input").forEach((e=>{e.addEventListener("change",(e=>{e.preventDefault();const t=e.target.dataset.identifier,n=Array.from(this.querySelectorAll(".ps-brand-item input:checked"));if(0===n.length)this.phoneListData=[...this.fullPhoneListData];else if(1===n.length){const e=n[0].dataset.identifier;this.phoneListData=this.fullPhoneListData.filter((t=>t.brand===e))}else if(e.target.checked){const e=n.map((e=>e.dataset.identifier));this.phoneListData=this.fullPhoneListData.filter((t=>e.includes(t.brand)))}else this.phoneListData=this.phoneListData.filter((e=>e.brand!==t));this.shouldSwitchPanelOnClick&&this._switchListPanel(null,"phone"),this._renderPhoneList(),this._addPhoneEventListeners(),this._updateClearBrandsButtonVisibility()}))}))}_addPhoneEventListeners(){this.querySelectorAll(".ps-phone-item input").forEach((e=>{e.addEventListener("change",(async n=>{n.preventDefault();const r=n.target.closest(".ps-phone-item");r.setAttribute("aria-busy","true"),e.disabled=!0;const i=n.target.dataset.identifier,a=c.isFRDataLoaded(i);try{await c.toggleFRData("phone",i,!a)}catch(n){e.checked=a,console.error("Failed to toggle phone data:",n)}finally{e.disabled=!1,r.setAttribute("aria-busy","false")}!t.get("INTERFACE.ALLOW_REMOVING_PHONE_FROM_SELECTOR")&&e.checked&&(e.disabled=!0)}))}))}_filterPhoneList(e){const t=e.toLowerCase().trim();this.querySelectorAll(".ps-phone-item").forEach((e=>{const n=e.querySelector(".ps-phone-name").textContent.toLowerCase().includes(t)?"flex":"none";e.style.display=n}))}_changePhoneItemBtnStatus(e,n){this._updateBtnStatTimeout&&this._previousBtnTarget===e.detail.identifier&&clearTimeout(this._updateBtnStatTimeout),!n&&c.isFRDataLoaded(e.detail.identifier)||(this._previousBtnTarget=e.detail.identifier,this._updateBtnStatTimeout=setTimeout((()=>{if(n){const n=this.querySelector(`.ps-phone-item input[data-identifier="${e.detail.identifier}"]`);n&&(n.checked=!0,t.get("INTERFACE.ALLOW_REMOVING_PHONE_FROM_SELECTOR")||(n.disabled=!0))}else{const t=this.querySelector(`.ps-phone-item input[data-identifier="${e.detail.identifier}"]`);t&&(t.checked=!1,t.disabled=!1)}this._updateBtnStatTimeout=null}),100))}_clearBrandSelection(){this.querySelectorAll(".ps-brand-item input:checked").forEach((e=>{e.checked=!1})),this.phoneListData=[...this.fullPhoneListData],this._renderPhoneList(),this._addPhoneEventListeners(),this._updateClearBrandsButtonVisibility()}_updateClearBrandsButtonVisibility(){this.querySelectorAll(".ps-brand-item input:checked").length>0?(this.clearBrandsButton.classList.add("visible"),this.querySelector(".ps-brand-item:last-child").style.marginBottom="4rem",this.querySelector(".ps-phone-item:last-child").style.marginBottom="4rem"):(this.clearBrandsButton.classList.remove("visible"),this.querySelector(".ps-brand-item:last-child").style.marginBottom="0.75rem",this.querySelector(".ps-phone-item:last-child").style.marginBottom="0.75rem")}_switchListPanel(e,t){null!==e&&e.preventDefault(),this.querySelector(".ps-brand-list").classList.toggle("mobile-visible"),this.querySelector(".ps-phone-list").classList.toggle("mobile-visible"),this.querySelector(".ps-header-nav-"+("phone"===t?"brand":"phone")).style.display="",this.querySelector(`.ps-header-nav-${t}`).style.display="none"}_getScoreElement(e){if(!Number.isInteger(parseInt(e))||e<0&&5<e)return e;let t="";const n=Math.floor(e),r=e%1>=.5,i=5-Math.ceil(e);for(let e=0;e<n;e++)t+=L.Icon("starFill");r&&(t+=L.Icon("starHalf"));for(let e=0;e<i;e++)t+=L.Icon("starLine");return t}_updateLanguage(){this.querySelector(".ps-header-nav-brand").innerHTML="< "+e.getString("phone-selector.header-brand-btn","Brands"),this.querySelector(".ps-header-search").placeholder=e.getString("phone-selector.header-search-bar-placeholder","Search"),this.querySelector(".ps-header-nav-phone").innerHTML=e.getString("phone-selector.header-device-btn","Devices")+" >",this.querySelectorAll(".ps-link-review").forEach((t=>t.innerHTML=`${L.Icon("externalLink")} ${e.getString("phone-selector.item-review","Review")}`)),this.querySelectorAll(".ps-link-shop").forEach((t=>t.innerHTML=`${L.Icon("externalLink")} ${e.getString("phone-selector.item-shop","Shop")}`)),this.clearBrandsButton&&(this.clearBrandsButton.innerHTML=`\n        ${L.Icon("close","width: 1.25rem; height: 1.25rem; margin-right: 0.25rem")}\n        ${e.getString("phone-selector.clear-brands-btn","Unselect Brands")}\n      `)}}customElements.define("phone-selector",PhoneSelector);var T=Object.freeze({__proto__:null});class TargetSelector extends HTMLElement{constructor(){super(),this.targets=t.get("TARGET_MANIFEST")||[],this.className="target-selector-container",this.isCollapsed=!1;const n=document.createElement("style");n.textContent="\n  .target-selector-container {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: fit-content;\n  }\n\n  .target-selector-group {\n    display: inline-flex;\n    flex-direction: column;\n    width: 100%;\n    min-height: 0.5rem;\n    overflow: hidden;\n    border-radius: 0.3rem 0.3rem 0.3rem 0;\n    background: var(--gt-color-surface-container-high);\n    max-height: 1000px;\n    opacity: 1;\n    visibility: visible;\n    transform-origin: top;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n  \n  .target-selector-group.collapsed {\n    max-height: 0.5rem;\n    filter: var(--gt-hover-filter);\n  }\n  \n  .target-selector-group.collapsed .target-group-item {\n    opacity: 0;\n  }\n\n  .target-group-item {\n    display: flex;\n    flex-direction: row;\n    padding: 0.2rem 0;\n    overflow-x: scroll;\n    overflow-y: hidden;\n    width: 100%;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n  .target-group-item:first-child{\n    margin-top: 0.1rem;\n  }\n  .tsc-single-row {\n    display: block;\n    width: 100%;\n    overflow-x: scroll;\n\n    .target-selector-group {\n      width: auto;\n      flex-direction: row;\n      padding-right: 1rem;\n    }\n    .target-group-item {\n      width: auto;\n      overflow: hidden;\n    }\n    .target-list-container {\n      padding-right: 0;\n    }\n  }\n\n  .target-group-name span {\n    color: var(--gt-color-primary);\n    font-weight: 600;\n    min-width: min-content;\n    margin: 0;\n  }\n\n  .target-list-container {\n    display: flex;\n    align-items: center;\n    gap: 0.9rem;\n    padding: 0 1rem;\n    position: relative;\n    white-space: nowrap;\n  }\n\n  .target-list {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n    min-height: 2.5rem;\n  }\n\n  .target-list-item {\n    overflow: hidden;\n  }\n\n  .tsc-collapse-button-group {\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    width: 100%;\n    overflow: hidden;\n  }\n  \n  .tsc-collapse-button {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n    padding: 0.2rem 1rem 0.2rem 0.6rem;\n    height: 2.5rem;\n    width: fit-content;\n    font-weight: 500;\n    border-radius: 0 0 0.3rem 0.3rem;\n    color: var(--gt-color-on-surface);\n    background: var(--gt-color-surface-container-high);\n    border: 1px solid var(--gt-color-surface-container-highest);\n    cursor: pointer;\n    transition: transform 0.3s ease;\n  }\n  \n  .tsc-collapse-button span {\n    width: max-content;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n  \n  .tsc-collapse-button svg {\n    fill: var(--gt-color-on-surface);\n    transition: transform 0.3s ease;\n  }\n  \n  .tsc-collapse-button.collapsed svg {\n    transform: rotate(180deg);\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .tsc-collapse-button:hover {\n      background: var(--gt-color-surface-container-highest);\n      filter: var(--gt-hover-filter)\n    }\n  }\n\n  .tsc-single-row::-webkit-scrollbar, .target-group-item::-webkit-scrollbar, .target-selector-container::-webkit-scrollbar {\n    height: 0.4rem;\n  }\n  .tsc-single-row::-webkit-scrollbar-track, .target-group-item::-webkit-scrollbar-track, .target-selector-container::-webkit-scrollbar-track {\n    background: rgba(0,0,0,0.1);\n  }\n  .tsc-single-row::-webkit-scrollbar-thumb, .target-group-item::-webkit-scrollbar-thumb {\n    background: rgba(0,0,0,0.3);\n    border-radius: 1rem;\n  }\n",this.appendChild(n),this.targetSelectorGroup=document.createElement("div"),this.targetSelectorGroup.className="target-selector-group",this.appendChild(this.targetSelectorGroup),e.addObserver(this._updateLanguage.bind(this))}connectedCallback(){window.addEventListener("core:fr-target-added",(e=>this._tickTargetButton(e))),window.addEventListener("core:fr-target-removed",(e=>this._untickTargetButton(e))),window.addEventListener("core:metadata-loaded",(()=>this._init()))}disconnectedCallback(){window.removeEventListener("core:fr-target-added",(e=>this._tickTargetButton(e))),window.removeEventListener("core:fr-target-removed",(e=>this._untickTargetButton(e))),window.removeEventListener("core:metadata-loaded",(()=>this._init())),e.removeObserver(this._updateLanguage.bind(this))}_init(){this._render(),t.get("INTERFACE.TARGET.ALLOW_MULTIPLE_LINE_PER_TYPE")?this.querySelectorAll(".target-group-item").forEach((e=>{this._addDragScroll(e)})):(this.classList.add("tsc-single-row"),this._addDragScroll(this)),n.dispatchInitEvent("target-ui-ready")}_render(){this.targets.forEach((e=>{const n=document.createElement("div");n.className="target-group-item",n.innerHTML=`\n        <div class="target-list-container">\n          <div class="target-group-name"><span>${e.type}</span></div>\n          <div class="target-list"></div>\n        </div>\n      `,e.files.forEach((e=>{const r=e.includes(" Target")?e:`${e} Target`,i=`\n          <gt-button toggleable variant='outlined' identifier='${r}' class='target-list-item'>\n            ${t.get("INTERFACE.TARGET.OMIT_TARGET_SUFFIX")?`<span class="targetname">${r.replace(" Target","")}</span>`:`<span class="targetname">${r}</span>`}\n          </gt-button>\n        `;n.querySelector(".target-list").insertAdjacentHTML("beforeend",i);const a=n.querySelector(".target-list > gt-button:last-child");a.addEventListener("gt-button-toggle",(async e=>{e.preventDefault(),a.disabled=!0,a.setAttribute("aria-busy","true");const t=c.isFRDataLoaded(r);try{await c.toggleFRData("target",r,!t)}catch(e){a.toggle(t,!0),console.error("Operation failed:",e)}finally{a.disabled=!1,a.setAttribute("aria-busy","false")}}))})),this.targetSelectorGroup.appendChild(n)})),t.get("INTERFACE.TARGET.ALLOW_MULTIPLE_LINE_PER_TYPE")&&(this.buttonGroup=document.createElement("div"),this.buttonGroup.className="tsc-collapse-button-group",this.collapseButton=document.createElement("button"),this.collapseButton.className="tsc-collapse-button",this.collapseButton.innerHTML=`\n        ${L.Icon("shortArrowUp","width: 1.25rem; height: 1.25rem;")}\n        <span>${e.getString("target-selector.label","Target")}</span>\n      `,this.collapseButton.addEventListener("click",this._toggleCollapse.bind(this)),this.buttonGroup.appendChild(this.collapseButton),this.appendChild(this.buttonGroup)),t.get("INTERFACE.TARGET.COLLAPSE_TARGET_LIST_ON_INITIAL")&&this._toggleCollapse()}_tickTargetButton(e){const t=this.querySelector(`.target-list-item[identifier="${e.detail.identifier}"]`);t&&t.toggle(!0,!0)}_untickTargetButton(e){const t=this.querySelector(`.target-list-item[identifier="${e.detail.identifier}"]`);t&&t.toggle(!1,!0)}_addDragScroll(e){let t,n,r=!1;e.addEventListener("mousedown",(i=>{i.preventDefault(),r=!0,e.style.cursor="grabbing",e.style.userSelect="none",t=i.pageX-e.offsetLeft,n=e.scrollLeft})),e.addEventListener("mouseleave",(()=>{r&&(r=!1,e.style.cursor="default",e.style.userSelect="")})),e.addEventListener("mouseup",(()=>{r&&(r=!1,e.style.cursor="default",e.style.userSelect="")})),e.addEventListener("mousemove",(i=>{if(!r)return;i.preventDefault();const a=1.5*(i.pageX-e.offsetLeft-t);e.scrollLeft=n-a})),e.style.cursor="default"}_toggleCollapse(){this.isCollapsed=!this.isCollapsed,this.isCollapsed?(this.targetSelectorGroup.classList.add("collapsed"),this.collapseButton.classList.add("collapsed")):(this.targetSelectorGroup.classList.remove("collapsed"),this.collapseButton.classList.remove("collapsed"))}_updateLanguage(){this.targets=t.get("TARGET_MANIFEST")||[],this.querySelectorAll(".target-group-name > span").forEach(((e,t)=>{e.textContent=this.targets[t]?.type})),this.collapseButton.innerHTML=`\n      ${L.Icon("shortArrowUp","width: 1.25rem; height: 1.25rem;")}\n      <span>${e.getString("target-selector.label","Target")}</span>\n    `}}customElements.define("target-selector",TargetSelector);var I=Object.freeze({__proto__:null});class NormalizerInput extends HTMLElement{constructor(){super(),this.normType=a.type,this.normValueHZ=a.Hzvalue,this.className="normalizer-input",this.innerHTML=`\n      <label class="normalizer-number">\n        <span>${e.getString("normalizer-input.label","Normalization")}</span>\n        <gt-divider style="margin: 0.25rem 0.5rem;"></gt-divider>\n        <input type="number" value="${this.normValueHZ}" min="20" max="20000" step="1"\n          placeholder="Hz for Normalization" ${"Avg"===this.normType?"disabled":""}\n        >\n      </label>\n      <label class="normalizer-radio Hz">\n        <input type="radio" name="normType" value="Hz" ${"Hz"===this.normType?"checked":""}>\n        <span>${e.getString("normalizer-input.hz-btn","Hz")}</span>\n      </label>\n      <label class="normalizer-radio Avg">\n        <input type="radio" name="normType" value="Avg" ${"Avg"===this.normType?"checked":""}>\n        <span>${e.getString("normalizer-input.avg-btn","Avg.")}</span>\n      </label>\n    `;const t=document.createElement("style");t.textContent='\n  .normalizer-input {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    padding: 0.25rem 0.25rem 0.25rem 1rem;\n    border: 1px solid var(--gt-color-outline);\n    border-radius: 3.5rem;\n  }\n\n  .normalizer-input input[type="radio"] {\n    display: none;\n  }\n\n  .normalizer-radio {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 3rem;\n    height: 1.75rem;\n    color: var(--gt-color-primary);\n    border: 1px solid var(--gt-color-outline);\n    cursor: pointer;\n    span {\n      font-weight: 600;\n    }\n  }\n  .normalizer-radio:has(input:checked) {\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n  }\n  .normalizer-radio.Hz {\n    padding-left: 0.25rem;\n    border-radius: 2.5rem 0 0 2.5rem;\n    border-right: 0;\n  }\n  .normalizer-radio.Avg {\n    padding-right: 0.25rem;\n    border-radius: 0 2.5rem 2.5rem 0;\n  }\n  .normalizer-radio:hover {\n    background: var(--gt-shadow);\n    filter: var(--gt-hover-filter);\n  }\n\n  .normalizer-number {\n    flex: 1;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    color: var(--gt-color-primary);\n    align-self: stretch;\n    font-weight: 500;\n    \n    input {\n      outline: 0;\n      border: 0;\n      padding: 0;\n      color: var(--gt-color-primary);\n      background: transparent;\n      font-weight: bold;\n      max-width: 4rem;\n    }\n    input:disabled {\n      filter: opacity(0.3);\n    }\n  }\n',this.appendChild(t),this._setupEventListeners()}connectedCallback(){e.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){e.removeObserver(this._updateLabel.bind(this))}_setupEventListeners(){this.querySelectorAll("input[type=radio]").forEach((e=>{e.addEventListener("change",(e=>{if(e.target.checked){a.updateNormalizationType(e.target.value),a.updateNormalization();this.querySelector("input[type=number]").toggleAttribute("disabled","Avg"===e.target.value)}}))})),this.querySelector('input[type="number"]').addEventListener("input",(e=>{const t=e.target.closest(".dB")?"dB":"Hz",n=parseFloat(e.target.value);a.updateNormalizationValue(t,n),a.updateNormalization()}))}_updateLabel(){this.querySelector(".normalizer-number > span").textContent=e.getString("normalizer-input.label","Normalization"),this.querySelector(".normalizer-radio.Hz > span").textContent=e.getString("normalizer-input.hz-btn","Hz"),this.querySelector(".normalizer-radio.Avg > span").textContent=e.getString("normalizer-input.avg-btn","Avg.")}}customElements.define("normalizer-input",NormalizerInput);var A=Object.freeze({__proto__:null});class SelectionList extends HTMLElement{constructor(){super(),this._boundHandleItemAdded=this._handleItemAdded.bind(this),this._boundHandleItemRemoved=this._handleItemRemoved.bind(this),this._boundHandleItemUpdated=this._handleItemUpdated.bind(this),this._boundUpdateLanguage=this._updateLanguage.bind(this),this.listSection=null,this.styleElement=null,this.init()}init(){this.styleElement=document.createElement("style"),this.styleElement.textContent='\n  .selection-list {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    padding: 0.5rem;\n    margin-bottom: 1rem;\n    border-radius: 0.5rem;\n    background: var(--gt-color-surface-container-highest);\n    container-type: inline-size;\n    container-name: selection-list;\n  }\n\n  .selection-list-item {\n    display: flex;\n    flex-direction: column;\n    border-radius: 0.4rem;\n    color: var(--gt-color-on-surface);\n    background: var(--gt-color-surface);\n  }\n  .selection-list-item:has(.sl-variant-btn.active) {\n    background: none;\n  }\n\n  .sl-item-content {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    padding: 0.8rem 0.7rem 0.8rem 0.9rem;\n  }\n  .sl-item-content:has(.sl-variant-btn.active) {\n    background: var(--gt-color-surface);\n    border: 1px solid var(--gt-color-outline);\n    border-radius: 0.4rem;\n  }\n\n  .sl-item-heading {\n    flex: 1;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.25rem;\n    overflow-x: hidden;\n    position: relative;\n\n    &::after {\n      content: \'\';\n      position: absolute;\n      right: 0;\n      top: 0;\n      height: 100%;\n      width: 2rem;\n      background: linear-gradient(to right, transparent, var(--gt-color-surface));\n      pointer-events: none;\n    }\n\n    span {\n      font-size: 0.85rem;\n      font-weight: 600;\n      white-space: nowrap;\n    }\n  }\n\n  .sl-item-leading {\n    display: flex;\n    flex-wrap: wrap;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.7rem;\n  }\n\n  .sl-color-btn {\n    width: 1rem;\n    height: 1rem;\n    border: 1px solid var(--gt-color-on-surface);\n    border-radius: 1rem;\n    margin-right: 0.5rem;\n    cursor: pointer;\n  }\n\n  .sl-name {\n    flex: 1;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.3rem;\n    overflow-x: hidden;\n  }\n\n  .sl-variant-btn {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n    border-radius: 2rem;\n    margin: 0 0.2rem;\n    background: none;\n    border: 2px solid var(--gt-color-on-surface-variant);\n    color: var(--gt-color-on-surface-variant);\n\n    svg {\n      width: 1rem;\n      height: 1rem;\n    }\n  }\n\n  .sl-y-offset {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.2rem;\n    padding-left: 0.2rem;\n\n    svg {\n      width: 1rem;\n      height: 1rem;\n    }\n\n    input {\n      width: 1.6rem;\n      height: 1.6rem;\n      padding: 0 0.5rem;\n      border-radius: 0.5rem;\n      border: 1px solid var(--gt-color-outline);\n      outline: none;\n      color: var(--gt-color-on-surface);\n      background-color: var(--gt-color-surface-container-lowest);\n    }\n  }\n\n  .sl-y-offset-dec, .sl-y-offset-inc {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0;\n    width: 1.5rem;\n    height: 1.5rem;\n    border-radius: 1.5rem;\n    border: none;\n    cursor: pointer;\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n\n    svg {\n      width: 1rem;\n      height: 1rem;\n    }\n  }\n\n  .sl-channels-select {\n    width: 5rem;\n    height: 1.7rem;\n    margin-right: 0.1rem;\n    border-radius: 0.5rem;\n    color: var(--gt-color-on-surface);\n    background-color: var(--gt-color-surface-container-lowest);\n  }\n\n  .sl-button-row {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .sl-button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    width: 2rem;\n    height: 2rem;\n    background: none;\n    border: none;\n    border-radius: 2rem;\n    color: var(--gt-color-on-surface-variant);\n    svg {\n      width: 1.25rem;\n      height: 1.25rem;\n    }\n  }\n\n  .sl-variant-menu {\n    display: flex;\n    flex-direction: column;\n    border-radius: 0 0 0.5rem 0.5rem;\n    padding: 0 0.5rem;\n    background: var(--gt-color-surface-container-highest);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    overflow: hidden;\n    max-height: 0;\n    visibility: hidden;\n    opacity: 0;\n  }\n\n  .sl-variant-menu.active {\n    padding-bottom: 0.5rem;\n    max-height: 1000px;\n    visibility: visible;\n    opacity: 1;\n    transform-origin: top;\n  }\n\n  .sl-variant-item {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    cursor: pointer;\n    justify-content: space-between;\n    padding: 0.5rem 0.8rem;\n    background: var(--gt-color-surface-container);\n    border: 1px solid var(--gt-color-outline); \n    border-top: none;\n  }\n  .sl-variant-item:last-child {\n    border-radius: 0 0 0.5rem 0.5rem;\n  }\n  .sl-variant-item-name {\n    font-weight: 500;\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .sl-y-offset-dec:hover, .sl-y-offset-inc:hover {\n      background: var(--gt-color-primary);\n      filter: var(--gt-hover-filter);\n    }\n    .sl-button:hover {\n      background: var(--gt-shadow);\n    }\n    .sl-variant-item:hover {\n      background: var(--gt-shadow);\n    }\n    .sl-variant-item:has(.sl-button:hover) {\n      background: none;\n    }\n    .sl-button.add-variant:hover {\n      background: var(--gt-color-primary);\n      color: var(--gt-color-on-primary);\n    }\n  }\n\n  .sl-y-offset-dec:active, .sl-y-offset-inc:active {\n    filter: var(--gt-hover-filter);\n    transition: filter 0s;\n  }\n  .sl-button:active {\n    background: var(--gt-shadow);\n    transition: background 0s;\n  }\n  .sl-variant-item:active {\n    background: var(--gt-shadow);\n    transition: background 0s;\n  }\n  .sl-variant-item:has(.sl-button:active) {\n    background: none;\n    transition: background 0s;\n  }\n  .sl-button.add-variant:active {\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    transition: background 0s, color 0s;\n  }\n\n  @container selection-list (max-width: 700px) {\n    .sl-item-content {\n      flex-direction: column;\n      gap: 0.7rem;\n    }\n    .sl-item-heading, .sl-item-leading {\n      width: 100%;\n    }\n    .sl-item-leading {\n      justify-content: flex-end;\n    }\n  }\n\n  @container selection-list (min-width: 700px) {\n    .sl-item-content {\n      flex-direction: row;\n    }\n  }\n\n  select {\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    appearance: none;\n    border: 1px solid var(--gt-color-outline);\n    padding-left: 0.6rem;\n    background-repeat: no-repeat;\n    background-position: right center;\n    background-image: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23666"><path d="M12 15.0006L7.75732 10.758L9.17154 9.34375L12 12.1722L14.8284 9.34375L16.2426 10.758L12 15.0006Z"></path></svg>\');\n    outline: none;\n    cursor: pointer;\n  }\n  \n  /* Chrome, Safari, Edge, Opera */\n  input::-webkit-outer-spin-button,\n  input::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  /* Firefox */\n  input[type=number] {\n    -moz-appearance: textfield;\n  }\n',this.appendChild(this.styleElement),this.listSection=document.createElement("section"),this.listSection.className="selection-list",this.appendChild(this.listSection),this._updateList(),window.addEventListener("core:fr-phone-added",this._boundHandleItemAdded),window.addEventListener("core:fr-target-added",this._boundHandleItemAdded),window.addEventListener("core:fr-unknown-inserted",this._boundHandleItemAdded),window.addEventListener("core:fr-phone-removed",this._boundHandleItemRemoved),window.addEventListener("core:fr-target-removed",this._boundHandleItemRemoved),window.addEventListener("core:fr-unknown-removed",this._boundHandleItemRemoved),window.addEventListener("core:fr-variant-updated",this._boundHandleItemUpdated),e.addObserver(this._boundUpdateLanguage)}destroy(){window.removeEventListener("core:fr-phone-added",this._boundHandleItemAdded),window.removeEventListener("core:fr-target-added",this._boundHandleItemAdded),window.removeEventListener("core:fr-unknown-inserted",this._boundHandleItemAdded),window.removeEventListener("core:fr-phone-removed",this._boundHandleItemRemoved),window.removeEventListener("core:fr-target-removed",this._boundHandleItemRemoved),window.removeEventListener("core:fr-unknown-removed",this._boundHandleItemRemoved),window.removeEventListener("core:fr-variant-updated",this._boundHandleItemUpdated),e.removeObserver(this._boundUpdateLanguage)}_updateList(){if(!this.listSection)return;this.listSection.innerHTML="";Array.from(c.frDataMap).sort((([,e],[,t])=>"target"===e.type?-1:"target"===t.type?1:0)).forEach((([e,t])=>{const n=this._createListItemElement(e,t);this.listSection.appendChild(n),this._attachEventListenersToItem(n)}))}_createListItemElement(e,t){const n=document.createElement("div");return n.className="selection-list-item",n.dataset.uuid=e,n.dataset.type=t.type,n.innerHTML=`\n      <div class="sl-item-content">\n        <div class="sl-item-heading">\n          <button class="sl-color-btn" style="background: ${t.colors.AVG||t.colors}"></button>\n          <div class="sl-name">\n            <span class="sl-identifier">${t.identifier}</span>\n            ${"phone"===t.type&&t.meta.files.length>1?`\n              <button class="sl-variant-btn" title="Show Variants">${L.Icon("plus")}</button>\n              `:""}\n            <span class="sl-variant-name">${t.dispSuffix}</span>\n          </div>\n        </div>\n        <div class="sl-item-leading">\n          ${"target"!==t.type?`<div class="sl-channels">\n              <select class="sl-channels-select" title="Graph Channel">\n                ${this._getChannelOptions(Object.keys(t.channels),t.dispChannel)}\n              </select>\n            </div>`:""}\n          <div class="sl-y-offset">\n            <button class="sl-y-offset-dec">${L.Icon("arrowDown")}</button>\n            <input type="number" class="sl-y-offset-input" title="Move Graph Vertically" value="0" step="1">\n            <button class="sl-y-offset-inc">${L.Icon("arrowUp")}</button>\n          </div>\n          <div class="sl-button-row">\n            <div class="sl-baseline">\n              <button class="sl-button baseline" title="Set Baseline">${L.Icon("wave","width: 1.5rem; height: 1.5rem;")}</button>\n            </div>\n            <div class="sl-visibility">\n              <button class="sl-button visibility ${t.hidden?"hidden":""}" title="${t.hidden?"Show":"Hide"} Graph">\n                ${L.Icon(t.hidden?"eyeOff":"eyeOn","width: 1.5rem; height: 1.5rem;")}\n              </button>\n            </div>\n            <div class="sl-actions">\n              <button class="sl-button delete" title="Delete Graph">${L.Icon("delete","width: 1.5rem; height: 1.5rem;")}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n      ${["phone","target"].includes(t.type)&&t.meta.files.length>1?`\n      <div class="sl-variant-menu">\n        ${t.meta.files.map(((n,r)=>n.suffix!==t.dispSuffix?`<div class="sl-variant-item" data-uuid="${e}" data-index="${r}">\n              <span class="sl-variant-item-name">${t.identifier} ${n.suffix}</span>\n              <button class="sl-button add-variant">${L.Icon("plus")}</button>\n            </div>`:"")).join("")}\n      </div>\n      `:""}\n    `,n}_handleItemAdded(e){const{uuid:t}=e.detail,n=c.getFRData(t);if(!n)return;const r=this._createListItemElement(t,n),i=Array.from(this.listSection.children);let a=!1;if("target"===n.type){const e=i.find((e=>"target"!==e.dataset.type));e&&(this.listSection.insertBefore(r,e),a=!0)}a||this.listSection.appendChild(r),this._attachEventListenersToItem(r)}_handleItemRemoved(e){const{uuid:t}=e.detail,n=this.listSection.querySelector(`.selection-list-item[data-uuid="${t}"]`);n&&n.remove()}_handleItemUpdated(e){const{uuid:t}=e.detail,n=c.getFRData(t);if(!n)return;const r=this.listSection.querySelector(`.selection-list-item[data-uuid="${t}"]`);if(r){const e=this._createListItemElement(t,n);this.listSection.replaceChild(e,r),this._attachEventListenersToItem(e)}}_getChannelOptions(t,n=[]){let r="";return t.includes("L")&&(r+=`<option value="L" ${n.includes("L")&&!n.includes("R")?"selected":""}>\n        ${e.getString("selection-list.channel-left","L")}\n      </option>`),t.includes("R")&&(r+=`<option value="R" ${!n.includes("L")&&n.includes("R")?"selected":""}>\n        ${e.getString("selection-list.channel-right","R")}\n      </option>`),t.includes("L")&&t.includes("R")&&(r+=`<option value="L+R" ${n.includes("L")&&n.includes("R")?"selected":""}>\n        ${e.getString("selection-list.channel-left-and-right","L + R")}\n      </option>`),t.includes("AVG")&&(r+=`<option value="AVG" ${n.includes("AVG")?"selected":""}>\n        ${e.getString("selection-list.channel-average","Average")}\n      </option>`),r}_attachEventListenersToItem(e){const t=e.querySelector(".sl-color-btn");t&&t.addEventListener("click",(t=>{t.preventDefault();const n=e.dataset.uuid,r=e.dataset.type,i=c._getColorWithType(r);c.updateMetadata("uuid",n,"colors",i),t.target.style.background=i.AVG||i}));const r=e.querySelector(".sl-variant-btn");r&&r.addEventListener("click",(t=>{t.preventDefault();const n=t.currentTarget,r=e.querySelector(".sl-variant-menu"),i=n.classList.contains("active");i?(n.setAttribute("title","Show Variants"),n.innerHTML=L.Icon("plus")):(n.setAttribute("title","Hide Variants"),n.innerHTML=L.Icon("subtract")),r.classList.toggle("active",!i),n.classList.toggle("active",!i)})),e.querySelectorAll(".sl-variant-item").forEach((t=>{t.addEventListener("click",(async n=>{if(n.target.closest(".add-variant"))return;n.preventDefault();t.closest(".sl-variant-menu").setAttribute("aria-busy","true");const r=e.dataset.uuid,i=t.dataset.index,a=c.getFRData(r);await c.updateVariant(r,a.meta.files[parseInt(i)].suffix)}));const n=t.querySelector(".sl-button.add-variant");n&&n.addEventListener("click",(n=>{n.preventDefault(),n.stopPropagation();const r=e.dataset.uuid,i=t.dataset.index,a=c.getFRData(r);c.addFRData("phone",a.identifier,{dispSuffix:a.meta.files[parseInt(i)].suffix})}))}));const i=e.querySelector(".sl-channels-select");i&&i.addEventListener("change",(t=>{const n=e.dataset.uuid;c.updateMetadata("uuid",n,"dispChannel",{L:["L"],R:["R"],"L+R":["L","R"],AVG:["AVG"]}[t.target.value])}));const a=e.querySelector(".sl-y-offset");if(a){const t=a.querySelector(".sl-y-offset-input"),n=a.querySelector(".sl-y-offset-dec"),r=a.querySelector(".sl-y-offset-inc");t.addEventListener("input",(t=>{const n=e.dataset.uuid,r=parseFloat(t.target.value)||0;document.querySelectorAll(`.fr-graph-curve-container path[uuid='${n}']`).forEach((e=>{e.setAttribute("transform",`translate(0,${0-r})`)}))}));const setupLongPress=(e,t)=>{let n,r=!1;const performAction=()=>{const e=a.querySelector(".sl-y-offset-input"),n=parseInt(e.value)||0;e.value="inc"===t?n+1:n-1,e.dispatchEvent(new Event("input",{bubbles:!0}))};e.addEventListener("mousedown",(()=>{r=!0,performAction(),n=setInterval((()=>{r&&performAction()}),150)}));const stopAction=()=>{r=!1,clearInterval(n)};e.addEventListener("mouseup",stopAction),e.addEventListener("mouseleave",stopAction)};setupLongPress(n,"dec"),setupLongPress(r,"inc")}const o=e.querySelector(".sl-button.baseline");if(o){o.addEventListener("click",(t=>{t.preventDefault();const n=t.currentTarget,r=e.dataset.uuid,i=n.classList.contains("active");l.updateBaselineData(!i,{uuid:r}),this.listSection.querySelectorAll(".sl-button.baseline").forEach((e=>{e===n?i?(e.setAttribute("title","Set Baseline"),e.innerHTML=L.Icon("wave","width: 1.5rem; height: 1.5rem;"),e.classList.remove("active")):(e.setAttribute("title","Reset Baseline"),e.innerHTML=L.Icon("flatline","width: 1.5rem; height: 1.5rem;"),e.classList.add("active")):i||(e.classList.remove("active"),e.setAttribute("title","Set Baseline"),e.innerHTML=L.Icon("wave","width: 1.5rem; height: 1.5rem;"))}))}));const t=l.getBaselineData();t&&t.uuid===e.dataset.uuid&&(o.classList.add("active"),o.setAttribute("title","Reset Baseline"),o.innerHTML=L.Icon("flatline","width: 1.5rem; height: 1.5rem;"))}const s=e.querySelector(".sl-button.visibility");s&&s.addEventListener("click",(t=>{t.preventDefault();const r=t.currentTarget,i=e.dataset.uuid,a=c.getFRData(i);if(!a)return;const o=document.querySelectorAll(`.fr-graph-curve-container path[uuid='${i}']`),s=!r.classList.contains("hidden");a.hidden=s,s?(o.forEach((e=>{e.style.display="none"})),r.setAttribute("title","Show Graph"),r.innerHTML=L.Icon("eyeOff","width: 1.5rem; height: 1.5rem;")):(o.forEach((e=>{e.style.display=""})),r.setAttribute("title","Hide Graph"),r.innerHTML=L.Icon("eyeOn","width: 1.5rem; height: 1.5rem;")),r.classList.toggle("hidden",s),n.dispatchEvent("fr-visibility-updated")}));const d=e.querySelector(".sl-button.delete");d&&d.addEventListener("click",(t=>{t.preventDefault();const n=e.dataset.uuid,r=e.dataset.type;c.removeFRDataWithUUID(r,n)}))}_updateLanguage(){this.listSection.querySelectorAll(".selection-list-item").forEach((e=>{const t=e.dataset.uuid,n=c.getFRData(t);if(!n)return;const r=e.querySelector(".sl-channels-select");r&&(r.innerHTML=this._getChannelOptions(Object.keys(n.channels),n.dispChannel))}))}static getElement(){return SelectionList.element||(SelectionList.element=new SelectionList),SelectionList.element}}customElements.define("selection-list",SelectionList);var M=Object.freeze({__proto__:null});class DragDivider extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.class="main-divider",this.shadowRoot.innerHTML="\n      <style>\n        :host {\n          display: block;\n          width: 5px;\n          background: var(--gt-color-outline-variant);\n          cursor: col-resize;\n          transition: background 0.2s;\n        }\n        :host(.dragging) {\n          background: var(--gt-color-primary);\n        }\n      </style>\n    ",this._isDragging=!1,this._startX=0,this._initialWidth=0}connectedCallback(){this.addEventListener("mousedown",this._startDrag),document.addEventListener("mouseup",this._stopDrag),document.addEventListener("mousemove",this._handleDrag)}disconnectedCallback(){this.removeEventListener("mousedown",this._startDrag),document.removeEventListener("mouseup",this._stopDrag),document.removeEventListener("mousemove",this._handleDrag)}_startDrag=e=>{this._isDragging=!0,this._startX=e.clientX,this._initialWidth=this.parentElement.getBoundingClientRect().width,this.classList.add("dragging")};_handleDrag=e=>{if(!this._isDragging)return;const t=e.clientX-this._startX;this.dispatchEvent(new CustomEvent("drag-divider-moved",{detail:{deltaX:t,currentX:e.clientX},bubbles:!0,composed:!0}))};_stopDrag=()=>{this._isDragging&&(this._isDragging=!1,this.classList.remove("dragging"))}}customElements.define("drag-divider",DragDivider);var k=Object.freeze({__proto__:null});class SmoothingButton extends HTMLElement{constructor(){super(),this._options=["1/48","1/24","1/12","1/6","1/3"],this._currentIndex=0,this.innerHTML=`\n      <gt-button variant="outlined" style="height: 2.5rem">\n        <span>${e.getString("smoothing-button.label","Smoothing")}</span>\n        <gt-divider style="width: 1px"></gt-divider>\n        <b>${this._options[this._currentIndex]}oct</b>\n      </gt-button>\n    `,this._button=this.querySelector("gt-button"),this._button.addEventListener("click",this._cycleOption.bind(this))}connectedCallback(){e.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){e.removeObserver(this._updateLabel.bind(this))}_cycleOption(t){t.preventDefault(),this._currentIndex=(this._currentIndex+1)%this._options.length,this._button.innerHTML=`\n      ${e.getString("smoothing-button.label","Smoothing")}\n      <gt-divider style="width: 1px"></gt-divider>\n      <b>${this._options[this._currentIndex]}oct</b>\n    `,s.updateSmoothing(this._options[this._currentIndex])}_updateLabel(){this.querySelector("span").textContent=e.getString("smoothing-button.label","Smoothing")}}customElements.define("smoothing-button",SmoothingButton);var R=Object.freeze({__proto__:null});class GraphScaleButton extends HTMLElement{constructor(){super();const n=parseInt(t.get("VISUALIZATION.DEFAULT_Y_SCALE"))||60;this._options=[40,60,80,100],this._currentIndex=this._options.indexOf(n)||1,this.innerHTML=`\n      <gt-button variant="outlined" style="height: 2.5rem">\n        <span>${e.getString("y-axis-scale-button.label","Y-Axis Scale")}</span>\n        <gt-divider style="width: 1px"></gt-divider>\n        <b>${this._options[this._currentIndex]}dB</b>\n      </gt-button>\n    `,this._button=this.querySelector("gt-button"),this._button.addEventListener("click",this._cycleOption)}connectedCallback(){e.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){e.removeObserver(this._updateLabel.bind(this))}_cycleOption=t=>{t.preventDefault(),this._currentIndex=(this._currentIndex+1)%this._options.length,this._button.innerHTML=`\n      ${e.getString("y-axis-scale-button.label","Y-Axis Scale")}\n      <gt-divider style="width: 1px"></gt-divider>\n      <b>${this._options[this._currentIndex]}dB</b>\n    `,l.updateYScale(this._options[this._currentIndex])};_updateLabel(){this.querySelector("span").textContent=e.getString("y-axis-scale-button.label","Y-Axis Scale")}}customElements.define("graph-scale-button",GraphScaleButton);var D=Object.freeze({__proto__:null});class GraphScreenshotButton extends HTMLElement{constructor(){super(),this.innerHTML=`\n      <gt-button variant="filled-tonal" style="height: 2.5rem">\n        ${L.Icon("screenshot","margin-top: -2px; width: 1.2rem; height: 1.2rem;")}\n        <span>${e.getString("screenshot-button.label","Screenshot")}</span>\n      </gt-button>\n    `,this._boundCapture=this.capture.bind(this),this._boundApplyComputedStyles=this._applyComputedStyles.bind(this),this._button=this.querySelector("gt-button"),this._button.addEventListener("click",(e=>this._boundCapture(e,"graph")))}connectedCallback(){e.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){e.removeObserver(this._updateLabel.bind(this))}capture(e,t="fr-graph"){e.preventDefault();const n=document.getElementById("fr-graph");if(!n)return void console.error("FR Graph not found");const r=n.querySelector(".y-scaler-handle");r&&(r.style.display="none");const i=n.cloneNode(!0);i.setAttribute("width",n.viewBox.baseVal.width),i.setAttribute("height",n.viewBox.baseVal.height),this._boundApplyComputedStyles(i),this._embedImages(i).then((()=>{const e=(new XMLSerializer).serializeToString(i),r=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),a=URL.createObjectURL(r),o=new Image;o.crossOrigin="anonymous",o.onload=()=>{const e=document.createElement("canvas");e.width=2*n.viewBox.baseVal.width,e.height=2*n.viewBox.baseVal.height;const r=e.getContext("2d");r.fillStyle=getComputedStyle(document.querySelector(".main-graph")).backgroundColor,r.fillRect(0,0,e.width,e.height),r.scale(2,2),r.drawImage(o,0,0);const i=document.createElement("a");i.download=`${t}.png`,i.href=e.toDataURL("image/png",1),i.click(),URL.revokeObjectURL(a)};const s=new FileReader;s.onloadend=()=>{o.src=s.result},s.readAsDataURL(r)})),r&&(r.style.display="block")}_applyComputedStyles(e){const t=window.getComputedStyle(document.getElementById("fr-graph"));e.style.backgroundColor=t.backgroundColor;const n=e.querySelectorAll("*"),r=document.getElementById("fr-graph").querySelectorAll("*");n.forEach(((e,t)=>{const n=r[t];if(!n)return;const i=window.getComputedStyle(n);["fill","stroke","stroke-width","opacity","font-size","font-family","font-weight","text-anchor","transform","mask","clip-path","display","visibility"].forEach((t=>{const n=i.getPropertyValue(t);n&&"none"!==n&&(e.style[t]=n)}));(i.cssText.match(/--[\w-]+/g)||[]).forEach((t=>{const n=i.getPropertyValue(t);n&&e.style.setProperty(t,n)})),"text"===e.tagName&&(e.style.fill=i.fill,e.style.fontFamily=i.fontFamily,e.style.fontSize=i.fontSize)}))}async _embedImages(e){const t=e.querySelectorAll("image"),n=Array.from(t).map((async e=>{const t=e.getAttribute("href")||e.getAttribute("xlink:href");if(t)try{const n=await fetch(t),r=await n.blob();return new Promise((t=>{const n=new FileReader;n.onloadend=()=>{e.setAttribute("href",n.result),t()},n.readAsDataURL(r)}))}catch(e){console.warn("Failed to embed image:",t,e)}}));await Promise.all(n)}_updateLabel(){this.querySelector("span").textContent=e.getString("screenshot-button.label","Screenshot")}}customElements.define("graph-screenshot-button",GraphScreenshotButton);var H=Object.freeze({__proto__:null});class ShareButton extends HTMLElement{constructor(){super(),this._buttonStyle="margin-top: -1px; width: 1.2rem; height: 1.2rem;",this.innerHTML=`\n      <gt-button variant="filled-tonal" style="height: 2.5rem">\n        ${L.Icon("share",this._buttonStyle)}\n        <span>${e.getString("share-button.label","Share")}</span>\n      </gt-button>\n    `,this._button=this.querySelector("gt-button"),this._button.addEventListener("click",this._copyURL)}connectedCallback(){e.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){e.removeObserver(this._updateLabel.bind(this))}_copyURL=async t=>{t.preventDefault(),await navigator.clipboard.writeText(p.getCurrentURL()),this._button.innerHTML=`\n      ${L.Icon("share",this._buttonStyle)}\n      ${e.getString("share-button.on-click","Copied!")}\n    `,setTimeout((()=>{this._button.innerHTML=`\n        ${L.Icon("share",this._buttonStyle)}\n        ${e.getString("share-button.label","Share")}\n      `}),1e3)};_updateLabel(){this.querySelector("span").textContent=e.getString("share-button.label","Share")}}customElements.define("share-button",ShareButton);var N=Object.freeze({__proto__:null});class LanguageSelector extends HTMLElement{constructor(){super(),this._langList=t.get("LANGUAGE.LANGUAGE_LIST")||["en","English"];const n=this._langList.map((([e,t])=>`<option value="${e}">${t||e}</option>`)).join("");this.innerHTML=`\n      <select class="lang-select">\n        ${n}\n      </select>\n      <style>\n        language-selector {\n          flex: 1;\n        }\n        .lang-select {\n          width: 100%;\n          height: 100%;\n          padding: 0.5rem;\n        }\n      </style>\n    `,this.select=this.querySelector(".lang-select"),this.select.value=e.getCurrentLanguage(),this.select.addEventListener("change",(async()=>{await e.loadLanguage(this.select.value)}))}}customElements.define("language-selector",LanguageSelector);var O=Object.freeze({__proto__:null});class TutorialModal extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.isMobile=window.innerWidth<1e3,this.os=this.detectOS(),this.currentStep=0,this.tutorialSteps=[],this.tutorialShownKey="modernGraphToolTutorialShown"}connectedCallback(){"true"===localStorage.getItem(this.tutorialShownKey)||(this.updateTutorialSteps(),this.render(),e.addObserver(this.updateLanguage.bind(this)),requestAnimationFrame((()=>{document.querySelector(this.tutorialSteps[1].selector)?this.showStep(this.currentStep):(console.warn("TutorialModal: Could not find element for the first step:",this.tutorialSteps[1].selector),this.finishTutorial(!1))})))}render(){const e=document.createElement("style");e.textContent="\n  :host {\n    position: fixed;\n    inset: 0;\n    z-index: 400; \n    pointer-events: none; \n  }\n\n  .overlay-part {\n    position: fixed;\n    background-color: rgba(0, 0, 0, 0.6); \n    z-index: 401; \n    pointer-events: auto; \n    display: none; \n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n\n  .overlay-top { height: 0; }\n  .overlay-bottom { top: auto; bottom: 0; height: 0; }\n  .overlay-left { width: 0; height: 0; }\n  .overlay-right { left: auto; right: 0; width: 0; height: 0; }\n\n  .tooltip-modal {\n    position: fixed; /* Position relative to viewport */\n    display: none; /* Hidden by default */\n    flex-direction: column;\n    background-color: var(--gt-color-surface-container-highest);\n    color: var(--gt-color-on-surface);\n    padding: 1rem;\n    border-radius: 0.75rem;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 402;\n    pointer-events: auto; /* Capture clicks on modal */\n    max-width: 300px;\n    border: 1px solid var(--gt-color-outline-variant);\n  }\n\n  .tooltip {\n    margin-bottom: 0.5rem;\n    line-height: 1.4;\n  }\n\n  .navigation {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 0.5rem;\n    border-top: 1px solid var(--gt-color-outline-variant);\n    padding-top: 0.75rem;\n    margin-top: 0.5rem;\n  }\n\n  .navigation button {\n    padding: 0.4rem 0.8rem;\n    border: none;\n    border-radius: 1rem;\n    cursor: pointer;\n    background-color: var(--gt-color-secondary);\n    color: var(--gt-color-on-secondary);\n    font: var(--gt-typescale-body-small);\n    transition: background-color 0.2s ease;\n  }\n\n  .navigation button:hover:not(:disabled) {\n    filter: brightness(0.95);\n  }\n\n  .navigation button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .navigation .skip-btn {\n    background-color: transparent;\n    color: var(--gt-color-on-surface-variant);\n    margin-left: auto; /* Push skip button to the right */\n  }\n   .navigation .skip-btn:hover {\n     background-color: var(--gt-color-surface-variant, #eee);\n   }\n\n  .step-indicator {\n    font: var(--gt-typescale-body-small);\n    color: var(--gt-color-on-surface-variant);\n  }\n\n  /* PWA Modal Styles */\n  .page-modal {\n    position: fixed;\n    inset: 0;\n    display: none; \n    justify-content: center;\n    align-items: center;\n    background-color: rgba(0, 0, 0, 0.6); \n    z-index: 404; \n    pointer-events: auto;\n  }\n\n  .page-modal-container {\n    background-color: var(--gt-color-surface-container-highest);\n    color: var(--gt-color-on-surface);\n    padding: 1.5rem;\n    border-radius: 1rem;\n    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);\n    max-width: 90vw;\n    width: 400px;\n    text-align: center;\n    border: 1px solid var(--gt-color-outline);\n  }\n\n  .page-modal-container h3 {\n    margin-top: 0;\n    margin-bottom: 1rem;\n    color: var(--gt-color-primary);\n    font: var(--gt-typescale-title-medium);\n  }\n\n  .page-modal-container p {\n    margin-bottom: 1.5rem;\n    line-height: 1.5;\n    white-space: pre-wrap; /* Respect line breaks in instructions */\n  }\n\n  .page-modal-close-btn {\n    padding: 0.6rem 1.5rem;\n    border: none;\n    border-radius: 1.5rem;\n    cursor: pointer;\n    background-color: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    transition: background-color 0.2s ease;\n  }\n\n  .page-modal-close-btn:hover {\n     filter: brightness(0.9);\n  }\n",this.shadowRoot.innerHTML='\n      <div class="overlay-part overlay-top"></div>\n      <div class="overlay-part overlay-bottom"></div>\n      <div class="overlay-part overlay-left"></div>\n      <div class="overlay-part overlay-right"></div>\n      <div class="tooltip-modal">\n        <div class="tooltip"></div>\n        <div class="navigation">\n          <button class="prev-btn" disabled>Previous</button>\n          <span class="step-indicator"></span>\n          <button class="next-btn">Next</button>\n          <button class="skip-btn">Skip</button>\n        </div>\n      </div>\n      <div class="page-modal" style="display: none;">\n        <div class="page-modal-container">\n          <h3 class="page-modal-title"></h3>\n          <p class="page-modal-content"></p>\n          <button class="page-modal-close-btn"></button>\n        </div>\n      </div>\n    ',this.shadowRoot.appendChild(e),this.overlayParts=this.shadowRoot.querySelectorAll(".overlay-part"),this.overlayTop=this.shadowRoot.querySelector(".overlay-top"),this.overlayBottom=this.shadowRoot.querySelector(".overlay-bottom"),this.overlayLeft=this.shadowRoot.querySelector(".overlay-left"),this.overlayRight=this.shadowRoot.querySelector(".overlay-right"),this.tooltipModal=this.shadowRoot.querySelector(".tooltip-modal"),this.tooltipElement=this.shadowRoot.querySelector(".tooltip"),this.prevBtn=this.shadowRoot.querySelector(".prev-btn"),this.nextBtn=this.shadowRoot.querySelector(".next-btn"),this.skipBtn=this.shadowRoot.querySelector(".skip-btn"),this.stepIndicator=this.shadowRoot.querySelector(".step-indicator"),this.pageModal=this.shadowRoot.querySelector(".page-modal"),this.pageTitle=this.shadowRoot.querySelector(".page-modal-title"),this.pageContent=this.shadowRoot.querySelector(".page-modal-content"),this.pageCloseBtn=this.shadowRoot.querySelector(".page-modal-close-btn"),this.prevBtn.addEventListener("click",(()=>this.prevStep())),this.nextBtn.addEventListener("click",(()=>this.nextStep())),this.skipBtn.addEventListener("click",(()=>this.finishTutorial(!0))),this.pageCloseBtn.addEventListener("click",(()=>this.closePageModal())),this.overlayParts.forEach((e=>{e.addEventListener("click",(()=>this.nextStep()))}))}updateTutorialSteps(){this.tutorialSteps=[{type:"page",title:e.getString("tutorial-modal.intro-title","Welcome to modernGraphTool"),text:e.getString("tutorial-modal.intro-content","A completely re-engineered, graph-sniffing experience."),btnText:e.getString("tutorial-modal.intro-close-btn","Next")},{selector:"menu-carousel",text:e.getString("tutorial-modal.menu-content","You can slide the menu to the left or right to access the variety of tools."),position:"top"},{selector:".y-scaler-handle circle",text:e.getString("tutorial-modal.graph-handle-content","You can drag this handle to shift graph vertically. Double click to reset position."),position:"left"}],this.isMobile?"iOS"!==this.os&&"Android"!==this.os||this.tutorialSteps.push({type:"page",title:e.getString("tutorial-modal.pwa-title","Use as App (PWA)"),text:this.getPWAInstruction(),btnText:e.getString("tutorial-modal.pwa-close-btn","Got It!")}):this.tutorialSteps.push({selector:"drag-divider",text:e.getString("tutorial-modal.divider-content","You can drag this divider to change the size of the graph."),position:"left"})}showStep(t){this.pageModal.style.display="none",this.tooltipModal.style.display="flex",this.overlayParts.forEach((e=>e.style.display="block"));const n=this.tutorialSteps[t];if("page"===n.type)return this.overlayParts.forEach((e=>e.style.display="none")),void this.showPageModal(n);const r=document.querySelector(n.selector);if(!r)return console.warn(`TutorialModal: Element not found for step ${t}: ${n.selector}`),void(t<this.tutorialSteps.length-1?(this.currentStep++,this.showStep(this.currentStep)):this.finishTutorial(!0));r.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});const i=r.getBoundingClientRect();this.overlayTop.style.height=`${i.top}px`,this.overlayBottom.style.top=`${i.bottom}px`,this.overlayBottom.style.height=`calc(100vh - ${i.bottom}px)`,this.overlayLeft.style.top=`${i.top}px`,this.overlayLeft.style.height=`${i.height}px`,this.overlayLeft.style.width=`${i.left}px`,this.overlayRight.style.top=`${i.top}px`,this.overlayRight.style.height=`${i.height}px`,this.overlayRight.style.left=`${i.right}px`,this.overlayRight.style.width=`calc(100vw - ${i.right}px)`,this.tooltipElement.textContent=n.text;const a=this.tooltipModal.getBoundingClientRect();let o,s;const l=20;switch(n.position){case"top":o=i.top-a.height-l,s=i.left+i.width/2-a.width/2;break;case"bottom":o=i.bottom+l,s=i.left+i.width/2-a.width/2;break;case"left":o=i.top+i.height/2-a.height/2,s=i.left-a.width-l;break;default:o=i.top+i.height/2-a.height/2,s=i.right+l}o=Math.max(l,Math.min(o,window.innerHeight-a.height-l)),s=Math.max(l,Math.min(s,window.innerWidth-a.width-l)),this.tooltipModal.style.top=`${o}px`,this.tooltipModal.style.left=`${s}px`,this.prevBtn.disabled=0===t,this.nextBtn.textContent=t===this.tutorialSteps.length-1?e.getString("tutorial-modal.btn-done","Done"):e.getString("tutorial-modal.btn-next","Next"),this.stepIndicator.textContent=`${t+1} / ${this.tutorialSteps.length}`}nextStep(){this.currentStep<this.tutorialSteps.length-1?(this.currentStep++,this.showStep(this.currentStep)):this.finishTutorial(!0)}prevStep(){this.currentStep>0&&(this.currentStep--,this.showStep(this.currentStep))}finishTutorial(e){this.overlayParts&&this.overlayParts.forEach((e=>e.style.display="none")),this.shadowRoot.innerHTML="",e&&localStorage.setItem(this.tutorialShownKey,"true")}showPageModal(e){this.tooltipModal.style.display="none",this.overlayParts.forEach((e=>e.style.display="none")),this.pageTitle.innerText=e.title,this.pageContent.innerText=e.text,this.pageCloseBtn.innerText=e.btnText,this.pageModal.style.display="flex"}closePageModal(){this.pageModal.style.display="none",this.currentStep<this.tutorialSteps.length-1?this.nextStep():this.finishTutorial(!0)}getPWAInstruction(){const t=this.detectOS();let n=e.getString("tutorial-modal.pwa-content","modernGraphTool is built as a progressive web app (PWA). You can install it to your device for better experience.");return"iOS"===t?n+="\n\n"+e.getString("tutorial-modal.pwa-inst-ios","On Safari: Tap the Share button, then select 'Add to Home Screen'."):"Android"===t&&(n+="\n\n"+e.getString("tutorial-modal.pwa-inst-android","On Chrome: Tap the menu button (three dots), then select 'Install app' or 'Add to Home screen'.")),n}updateLanguage(){this.updateTutorialSteps(),this.prevBtn.innerText=e.getString("tutorial-modal.btn-prev","Previous"),this.nextBtn.innerText=e.getString("tutorial-modal.btn-next","Next"),this.skipBtn.innerText=e.getString("tutorial-modal.btn-skip","Skip"),this.pageCloseBtn.innerText=e.getString("tutorial-modal.intro-close-btn","Next")}detectOS(){const e=window.navigator.userAgent,t=window.navigator.platform;return-1!==["iPhone","iPad","iPod"].indexOf(t)||e.includes("Mac")&&"ontouchend"in document?"iOS":-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(t)?"MacOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(t)?"Windows":/Android/.test(e)?"Android":"Other"}}customElements.define("tutorial-modal",TutorialModal);var P=Object.freeze({__proto__:null});class GTButton extends HTMLElement{static get observedAttributes(){return["variant","disabled","toggleable"]}constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this._render()}_render(){this.shadow.innerHTML="",this.toggleable=null!==this.getAttribute("toggleable");const e=document.createElement(this.toggleable?"label":"button");if(e.classList.add("button"),this.toggleable){const t=document.createElement("input");t.type="checkbox",e.appendChild(t),e.classList.add("toggleable"),this.checkbox=t}const t=this.getAttribute("variant")||"filled";e.classList.add(t),this.hasAttribute("disabled")&&e.classList.add("disabled");const n=document.createElement("slot");e.appendChild(n);const r=document.createElement("style");r.textContent="\n  :host {\n    display: inline-flex;\n    border-radius: 2.5rem;\n  }\n\n  .button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0.5rem 1rem;\n    border-radius: 2.5rem;\n    cursor: pointer;\n    font-family: inherit;\n    font-size: 0.8rem;\n    font-weight: 500;\n    transition: all 0.2s ease;\n    width: 100%;\n    height: 100%;\n    gap: 0.5rem;\n\n    svg {\n      width: 1rem;\n      height: 1rem;\n    }\n  }\n\n  .button.disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    pointer-events: none;\n  }\n\n  .checkbox {\n    display: none;\n  }\n\n  .filled {\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    border: none;\n  }\n\n  .filled-tonal {\n    background: var(--gt-color-secondary-container);\n    color: var(--gt-color-on-secondary-container);\n    border: none;\n  }\n\n  .filled-tertiary {\n    background: var(--gt-color-tertiary-container);\n    color: var(--gt-color-on-tertiary-container);\n    border: none;\n  }\n\n  .outlined {\n    background: transparent;\n    border: 1px solid var(--gt-color-outline);\n    color: var(--gt-color-primary);\n  }\n\n  /* Style for Toggle Button */\n  .toggleable input {\n    display: none;\n  }\n\n  .toggleable.filled:has(input:checked) {\n    background: var(--gt-color-primary-container);\n    color: var(--gt-color-on-primary-container);\n  }\n\n  .toggleable.filled-tonal:has(input:checked) {\n    background: var(--gt-color-secondary);\n    color: var(--gt-color-on-secondary);\n  }\n\n  .toggleable.filled-tertiary:has(input:checked) {\n    background: var(--gt-color-tertiary);\n    color: var(--gt-color-on-tertiary);\n  }\n\n  .toggleable.outlined:has(input:checked) {\n    border: 1px solid var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    background: var(--gt-color-primary);\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .filled:hover {\n      filter: var(--gt-hover-filter);\n    }\n    .filled-tonal:hover {\n      filter: var(--gt-hover-filter);\n    }\n    .filled-tertiary:hover {\n      filter: var(--gt-hover-filter);\n    }\n    .outlined:hover {\n      background: var(--gt-shadow);\n    }\n  }\n\n  /* Touch feedback styles */\n  .filled:active {\n    filter: var(--gt-hover-filter);\n    transition: filter 0s;\n  }\n  .filled-tonal:active {\n    filter: var(--gt-hover-filter);\n    transition: filter 0s;\n  }\n  .filled-tertiary:active {\n    filter: var(--gt-hover-filter);\n    transition: filter 0s;\n  }\n  .outlined:active {\n    background: var(--gt-shadow);\n    transition: background 0s;\n  }\n",this.shadow.appendChild(e),this.shadow.appendChild(r)}attributeChangedCallback(e,t,n){t!==n&&this._render()}toggle(e,t=!1){this.toggleable&&(this.checkbox.checked=e,t||this.checkbox.dispatchEvent(new Event("change",{bubbles:!0})))}connectedCallback(){this.toggleable&&this.checkbox.addEventListener("change",(e=>{this.dispatchEvent(new CustomEvent("gt-button-toggle",{detail:{checked:e.target.checked},bubbles:!0}))}))}}customElements.define("gt-button",GTButton);var B=Object.freeze({__proto__:null});class GTDivider extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"});this.color=this.getAttribute("color")||"var(--gt-color-outline)",this.width=this.getAttribute("width")||"1px",this.style=this.getAttribute("style")||"",this.isHorizontal=this.hasAttribute("horizontal"),e.className="gt-divider",e.innerHTML=`\n      <style>\n        :host {\n          display: block;\n          width: ${this.isHorizontal?"100%":this.width};\n          height: ${this.isHorizontal?"1px":"auto"};\n          background: ${this.color};\n          align-self: stretch;\n          ${this.style};\n        }\n      </style>\n    `}}customElements.define("gt-divider",GTDivider);var $=Object.freeze({__proto__:null});export{n as CoreEvent,r as CoreExtension,c as DataProvider,a as FRNormalizer,i as FRParser,h as MenuState,d as MetadataParser,l as RenderEngine,e as StringLoader,p as URLProvider};
//# sourceMappingURL=core.min.js.map
